<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Stay Updated - Cybersecurity Threat Intelligence Feed Aggregator</title>
    <meta name="description" content="Real-time Cybersecurity Threat Intelligence Aggregator. Stay informed with the latest security news, advisories, and research from 55+ trusted sources including CISA, Krebs on Security, and more.">
    <meta name="keywords" content="cybersecurity, threat intelligence, security news, CISA, vulnerability, ransomware, security advisories">
    <meta name="author" content="Ashish">
    <meta name="theme-color" content="#4a9eff">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://ashizzz.github.io/StayUpdated/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Stay Updated - Cybersecurity Threat Intelligence Aggregator">
    <meta property="og:description" content="Real-time Cybersecurity Threat Intelligence Aggregator from 55+ trusted sources">
    <meta property="og:url" content="https://ashizzz.github.io/StayUpdated/">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Stay Updated - Cybersecurity Threat Intelligence">
    <meta name="twitter:description" content="Real-time Cybersecurity Threat Intelligence Aggregator from 55+ trusted sources">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Inter:wght@400;500;600;700&display=swap');

        :root {
            --background-color: #1a1a1a;
            --header-color: #1f1f1f;
            --text-color: #b3b3b3;
            --text-color-bright: #d0d0d0;
            --highlight-color: #4a9eff;
            --error-color: #ff6b6b;
            --success-color: #51cf66;
            --warning-color: #ffcc00;
            --loading-color: #ffcc00;
            --card-background: #252525;
            --card-hover: #2d2d2d;
            --hover-background: #5aaaff;
            --border-color: #3a3a3a;
            --input-background: #2d2d2d;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            --shadow-hover: 0 8px 30px rgba(74, 158, 255, 0.2);
            --gradient-primary: linear-gradient(135deg, #4a9eff 0%, #5aaaff 50%, #6bb5ff 100%);
            --gradient-card: linear-gradient(180deg, rgba(37, 37, 37, 0.95) 0%, rgba(29, 29, 29, 0.98) 100%);
            --glow-primary: 0 0 20px rgba(74, 158, 255, 0.3);
            --glow-hover: 0 0 30px rgba(74, 158, 255, 0.5);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--background-color);
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(74, 158, 255, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(90, 170, 255, 0.02) 0%, transparent 50%);
            background-attachment: fixed;
            color: var(--text-color);
            min-height: 100vh;
            line-height: 1.6;
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Skip to content link for accessibility */
        .skip-to-content {
            position: absolute;
            top: -100px;
            left: 0;
            background: var(--highlight-color);
            color: var(--text-color-bright);
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 0 0 8px 0;
            font-weight: 600;
            z-index: 10001;
            transition: top 0.3s ease;
        }

        .skip-to-content:focus {
            top: 0;
            outline: 3px solid var(--hover-background);
            outline-offset: 2px;
        }

        header {
            background: linear-gradient(180deg, rgba(31, 31, 31, 0.98) 0%, rgba(26, 26, 26, 0.95) 100%);
            padding: clamp(15px, 3vw, 25px) clamp(15px, 4vw, 20px);
            text-align: center;
            width: 100%;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3), 0 0 1px rgba(74, 158, 255, 0.1);
            border-bottom: 1px solid var(--border-color);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
        }

        header h1 {
            margin: 0 0 clamp(8px, 1.5vw, 10px) 0;
            font-size: clamp(1.5em, 5vw, 2.5em);
            color: var(--text-color-bright);
            text-shadow: none;
            font-weight: 700;
            letter-spacing: -0.5px;
            line-height: 1.2;
        }

        header .subtitle {
            font-size: clamp(0.85em, 2.5vw, 0.95em);
            color: var(--text-color);
            margin-bottom: clamp(10px, 2vw, 15px);
            line-height: 1.4;
        }

        .main-layout {
            display: flex;
            gap: clamp(15px, 3vw, 20px);
            width: 95%;
            max-width: 1600px;
            margin: clamp(15px, 3vw, 20px) auto;
            align-items: flex-start;
        }

        .sidebar {
            width: 350px;
            min-width: 300px;
            position: sticky;
            top: clamp(80px, 12vh, 100px);
            max-height: calc(100vh - clamp(100px, 15vh, 120px));
            overflow-y: auto;
            flex-shrink: 0;
            padding-right: 10px;
        }

        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: transparent;
            border-radius: 4px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--highlight-color), var(--hover-background));
            border-radius: 4px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: var(--hover-background);
        }

        .main-content {
            flex: 1;
            min-width: 0;
        }

        .controls-panel {
            background: var(--gradient-card);
            padding: clamp(16px, 3vw, 24px);
            margin-bottom: clamp(16px, 3vw, 24px);
            border-radius: clamp(10px, 2vw, 14px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            border: 1.5px solid var(--border-color);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .controls-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .controls-panel:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(74, 158, 255, 0.1);
            transform: translateY(-1px);
        }

        .controls-panel:hover::before {
            opacity: 1;
        }

        .controls-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
        }

        .controls-row:last-child {
            margin-bottom: 0;
        }

        .search-container {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 14px 45px 14px 18px;
            background: var(--input-background);
            border: 1.5px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-color);
            font-size: 0.95em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .search-input::placeholder {
            color: #777;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--highlight-color);
            box-shadow: 0 0 0 3px rgba(74, 158, 255, 0.1);
            background: var(--card-background);
            transform: translateY(-1px);
        }

        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
            pointer-events: none;
        }

        .filter-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .filter-select, .sort-select {
            padding: 12px 18px;
            background: var(--input-background);
            border: 1.5px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-color);
            font-size: 0.9em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .filter-select:hover, .sort-select:hover {
            border-color: var(--highlight-color);
            background: var(--card-background);
        }

        .filter-select:focus, .sort-select:focus {
            outline: none;
            border-color: var(--highlight-color);
            box-shadow: 0 0 0 3px rgba(74, 158, 255, 0.2);
            background: var(--card-background);
        }

        /* Enhanced focus indicators for better accessibility */
        button:focus-visible,
        .filter-action-btn:focus-visible,
        .preset-btn:focus-visible,
        .quick-action-btn:focus-visible,
        .action-btn:focus-visible {
            outline: 3px solid var(--highlight-color);
            outline-offset: 2px;
            border-color: var(--highlight-color);
        }

        /* Improved focus for interactive elements */
        input:focus-visible,
        select:focus-visible,
        textarea:focus-visible {
            outline: 3px solid var(--highlight-color);
            outline-offset: 2px;
        }

        .source-filters-container {
            width: 100%;
            background: var(--gradient-card);
            border-radius: clamp(10px, 2vw, 12px);
            padding: clamp(16px, 3vw, 20px);
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .source-filters-container:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.35), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .source-filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
            flex-wrap: wrap;
            gap: 12px;
        }

        .source-filters-title {
            font-size: 1.1em;
            font-weight: 700;
            color: var(--text-color-bright);
            display: flex;
            align-items: center;
            gap: 10px;
            letter-spacing: 0.3px;
        }

        .source-filters-title span:first-child {
            font-size: 1.3em;
        }

        .source-filter-actions {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .filter-action-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-color);
            font-size: 0.75em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .filter-action-btn:hover {
            background: var(--card-hover);
            border-color: var(--highlight-color);
            color: var(--highlight-color);
        }

        .filter-action-btn span:first-child {
            font-size: 0.9em;
            font-weight: 600;
        }

        .filter-presets {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 14px;
            padding: 0;
            background: transparent;
            border-radius: 0;
            border: none;
        }

        .preset-btn {
            padding: 5px 10px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            color: var(--text-color);
            font-size: 0.75em;
            font-weight: 400;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-btn:hover {
            background: var(--card-hover);
            border-color: var(--highlight-color);
            color: var(--highlight-color);
        }

        .preset-btn.active {
            background: rgba(74, 158, 255, 0.15);
            border-color: var(--highlight-color);
            color: var(--highlight-color);
            font-weight: 500;
        }

        .source-search {
            width: 100%;
            padding: 8px 32px 8px 12px;
            background: var(--input-background);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-color);
            font-size: 0.82em;
            margin-bottom: 14px;
            transition: all 0.2s ease;
        }

        .source-search::placeholder {
            color: #777;
            font-size: 0.9em;
        }

        .source-search:focus {
            outline: none;
            border-color: var(--highlight-color);
            box-shadow: 0 0 0 2px rgba(74, 158, 255, 0.1);
            background: var(--card-background);
        }

        .source-search-wrapper {
            position: relative;
            margin-bottom: 14px;
        }

        .source-search-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
            pointer-events: none;
            transition: color 0.2s;
            font-size: 0.85em;
        }

        .source-search:focus + .source-search-icon {
            color: var(--highlight-color);
        }

        .source-filters {
            max-height: calc(100vh - 500px);
            min-height: 300px;
            overflow-y: auto;
            padding-right: 6px;
            margin-top: 4px;
        }

        .source-filters-empty {
            text-align: center;
            padding: 40px 20px;
            color: #777;
            font-size: 0.9em;
        }

        .source-category {
            margin-bottom: 12px;
            border: none;
            border-radius: 0;
            overflow: visible;
            background: transparent;
        }

        .category-header {
            padding: 8px 0;
            background: transparent;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
            user-select: none;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 6px;
        }

        .category-header:hover {
            border-bottom-color: var(--highlight-color);
        }

        .category-title {
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
            font-size: 0.85em;
            color: var(--text-color);
            text-transform: none;
            letter-spacing: 0;
        }

        .category-title span:first-child {
            font-size: 1em;
            opacity: 0.7;
        }

        .category-badge {
            background: var(--border-color);
            color: var(--text-color);
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: 600;
            margin-left: 6px;
        }

        .category-toggle {
            color: var(--text-color);
            font-size: 0.75em;
            transition: transform 0.2s ease;
            font-weight: 600;
            opacity: 0.6;
        }

        .category-toggle.collapsed {
            transform: rotate(180deg);
        }

        .category-select-all {
            padding: 3px 8px;
            background: transparent;
            border: none;
            border-radius: 4px;
            color: var(--text-color);
            font-size: 0.7em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: auto;
            margin-right: 6px;
            opacity: 0.6;
        }

        .category-select-all:hover {
            background: var(--card-hover);
            color: var(--highlight-color);
            opacity: 1;
        }

        .category-content {
            padding: 4px 0;
            display: grid;
            grid-template-columns: 1fr;
            gap: 2px;
            max-height: 500px;
            overflow-y: auto;
            transition: max-height 0.25s ease, padding 0.25s ease, opacity 0.25s ease;
            opacity: 1;
        }

        .category-content:not(.expanded) {
            max-height: 0;
            padding: 0;
            opacity: 0;
            overflow: hidden;
        }

        .category-content::-webkit-scrollbar {
            width: 4px;
        }

        .category-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .category-content::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 2px;
        }

        .category-content::-webkit-scrollbar-thumb:hover {
            background: var(--highlight-color);
        }

        .source-filter-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 8px;
            border-radius: 4px;
            transition: all 0.15s ease;
            background: transparent;
            border: none;
            position: relative;
            margin-bottom: 1px;
            cursor: pointer;
        }

        .source-filter-item:hover {
            background: rgba(74, 158, 255, 0.05);
        }

        .source-filter-item.checked {
            background: rgba(74, 158, 255, 0.1);
        }

        .source-filter-item.checked::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--highlight-color);
            border-radius: 0 1px 1px 0;
        }

        .source-filter-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
            accent-color: var(--highlight-color);
            flex-shrink: 0;
            border-radius: 3px;
            margin: 0;
        }

        .source-filter-item label {
            font-size: 0.82em;
            cursor: pointer;
            user-select: none;
            flex: 1;
            color: var(--text-color);
            transition: color 0.15s ease;
            font-weight: 400;
            line-height: 1.4;
        }

        .source-filter-item:hover label,
        .source-filter-item.checked label {
            color: var(--text-color-bright);
            font-weight: 500;
        }

        .source-filter-item.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .source-filter-item.disabled:hover {
            background: transparent;
        }

        .source-count {
            font-size: 0.65em;
            color: var(--text-color);
            margin-left: auto;
            padding: 1px 6px;
            background: transparent;
            border-radius: 4px;
            font-weight: 500;
            min-width: 30px;
            text-align: center;
            transition: all 0.15s ease;
            opacity: 0.6;
        }

        .source-filter-item.checked .source-count {
            color: var(--highlight-color);
            opacity: 1;
        }

        .source-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-color);
            flex-shrink: 0;
            box-shadow: 0 0 8px var(--success-color);
        }

        .source-status.error {
            background: var(--error-color);
            box-shadow: 0 0 8px var(--error-color);
        }

        .source-status.loading {
            background: var(--warning-color);
            box-shadow: 0 0 8px var(--warning-color);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: clamp(12px, 2.5vw, 20px);
            padding: clamp(15px, 3vw, 20px) clamp(18px, 3.5vw, 28px);
            background: var(--gradient-card);
            margin-bottom: clamp(16px, 3vw, 24px);
            border-radius: clamp(10px, 2vw, 14px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            border: 1.5px solid var(--border-color);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .stats-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stats-bar:hover {
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(74, 158, 255, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }

        .stats-bar:hover::before {
            opacity: 0.6;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .quick-action-btn {
            padding: 10px 18px;
            background: linear-gradient(180deg, rgba(45, 45, 45, 0.95) 0%, rgba(37, 37, 37, 0.98) 100%);
            border: 1.5px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-color);
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 6px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .quick-action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(74, 158, 255, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
        }

        .quick-action-btn:hover::before {
            width: 200px;
            height: 200px;
        }

        .quick-action-btn:hover {
            background: linear-gradient(180deg, rgba(45, 45, 45, 1) 0%, rgba(37, 37, 37, 1) 100%);
            border-color: var(--highlight-color);
            color: var(--highlight-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(74, 158, 255, 0.25), 0 0 0 1px rgba(74, 158, 255, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
        }

        .stat-value {
            color: var(--highlight-color);
            font-weight: 600;
        }

        .last-updated {
            font-size: 0.85em;
            color: #777;
            margin-top: 8px;
            font-weight: 500;
        }

        .last-updated::before {
            content: 'üïí ';
            margin-right: 4px;
        }

        .auto-refresh-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85em;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
            background: var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
            outline: none;
        }

        .toggle-switch:focus-visible {
            outline: 3px solid var(--highlight-color);
            outline-offset: 2px;
        }

        .toggle-switch.active {
            background: var(--highlight-color);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: white;
            top: 3px;
            left: 3px;
            transition: transform 0.3s;
        }

        .toggle-switch.active::after {
            transform: translateX(20px);
        }

        .loading {
            font-size: 1em;
            color: var(--loading-color);
            margin: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .loading-progress {
            width: 300px;
            max-width: 90%;
            height: 4px;
            background: var(--input-background);
            border-radius: 2px;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--highlight-color), var(--hover-background));
            border-radius: 2px;
            transition: width 0.3s ease;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -300px 0; }
            100% { background-position: 300px 0; }
        }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top: 3px solid var(--highlight-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .feed-container {
            margin: 0;
            width: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(min(100%, 320px), 1fr));
            grid-gap: clamp(15px, 3vw, 25px);
            padding: 0 0 clamp(30px, 5vw, 40px) 0;
        }

        .feed-item {
            background: var(--gradient-card);
            padding: clamp(18px, 3vw, 24px);
            border-radius: clamp(10px, 2vw, 14px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            border: 1.5px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.5s ease;
        }

        .feed-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            border-color: var(--highlight-color);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        .feed-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--highlight-color);
            transform: scaleY(0);
            transition: transform 0.3s;
        }

        .feed-item:hover {
            transform: translateY(-6px) scale(1.01);
            box-shadow: 0 12px 28px rgba(0, 0, 0, 0.4), var(--glow-primary), inset 0 1px 0 rgba(255, 255, 255, 0.08);
            border-color: var(--highlight-color);
            background: linear-gradient(180deg, rgba(45, 45, 45, 0.98) 0%, rgba(37, 37, 37, 0.95) 100%);
        }

        .feed-item:hover::before {
            transform: scaleY(1);
            box-shadow: 0 0 10px rgba(74, 158, 255, 0.5);
        }

        .feed-item.hidden {
            display: none;
        }

        .feed-item a {
            color: inherit;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            height: 100%;
            position: relative;
        }

        .feed-item a::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 14px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .feed-item:hover a::after {
            box-shadow: inset 0 0 0 2px var(--highlight-color);
        }

        .feed-item img {
            width: 100%;
            height: clamp(150px, 25vw, 180px);
            object-fit: cover;
            border-radius: clamp(6px, 1.5vw, 8px);
            margin-bottom: clamp(12px, 2vw, 15px);
            background: var(--input-background);
            transition: transform 0.3s;
        }

        .feed-item:hover img {
            transform: scale(1.05);
        }

        .feed-item .no-image {
            width: 100%;
            height: clamp(150px, 25vw, 180px);
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0a0a0a 100%);
            background-size: 200% 200%;
            animation: gradientShift 4s ease infinite;
            border-radius: clamp(6px, 1.5vw, 8px);
            margin-bottom: clamp(12px, 2vw, 15px);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .feed-item .no-image::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(74, 158, 255, 0.03) 2px, rgba(74, 158, 255, 0.03) 4px),
                repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(74, 158, 255, 0.03) 2px, rgba(74, 158, 255, 0.03) 4px);
            opacity: 0.5;
        }

        .feed-item .no-image::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: 
                radial-gradient(circle at 30% 30%, rgba(74, 158, 255, 0.3), transparent 50%),
                linear-gradient(45deg, transparent 30%, rgba(74, 158, 255, 0.1) 50%, transparent 70%);
            border: 2px solid rgba(74, 158, 255, 0.3);
            border-radius: 8px;
            box-shadow: 
                0 0 20px rgba(74, 158, 255, 0.2),
                inset 0 0 20px rgba(74, 158, 255, 0.1);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { 
                opacity: 0.6;
                transform: translate(-50%, -50%) scale(1);
            }
            50% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
        }

        .feed-item h2 {
            font-size: clamp(1.1em, 2.5vw, 1.25em);
            color: var(--text-color-bright);
            margin: 0 0 clamp(10px, 2vw, 14px) 0;
            line-height: 1.5;
            font-weight: 700;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            transition: color 0.3s ease;
        }

        .feed-item:hover h2 {
            color: var(--highlight-color);
        }

        .feed-item .pub-date {
            font-size: 0.8em;
            color: #777;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .feed-item .reading-time {
            font-size: 0.75em;
            color: #777;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .feed-item .article-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .feed-item:hover .article-actions {
            opacity: 1;
        }

        .action-btn {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            background: rgba(26, 26, 26, 0.9);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            font-size: 0.9em;
        }

        .action-btn:hover {
            background: var(--highlight-color);
            border-color: var(--highlight-color);
            color: var(--text-color-bright);
            transform: scale(1.1);
        }

        .feed-item .source {
            font-size: 0.75em;
            color: var(--highlight-color);
            margin-top: auto;
            padding-top: 14px;
            border-top: 1.5px solid var(--border-color);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            transition: all 0.3s ease;
        }

        .feed-item:hover .source {
            color: var(--hover-background);
            border-color: var(--highlight-color);
        }

        .feed-item p {
            font-size: clamp(0.85em, 2vw, 0.9em);
            line-height: 1.6;
            margin-bottom: clamp(10px, 2vw, 12px);
            color: var(--text-color);
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            flex-grow: 1;
        }

        .feed-status {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success-color);
            box-shadow: 0 0 10px var(--success-color);
        }

        .feed-status.error {
            background: var(--error-color);
            box-shadow: 0 0 10px var(--error-color);
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: #777;
            grid-column: 1 / -1;
        }

        .empty-state h3 {
            font-size: 1.8em;
            margin-bottom: 15px;
            color: var(--text-color);
            font-weight: 600;
        }

        .empty-state p {
            font-size: 1.1em;
            color: #999;
            margin-bottom: 20px;
        }

        .error-message {
            font-size: 1em;
            color: var(--error-color);
            margin: 20px;
            text-align: center;
            padding: 15px;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 8px;
            border: 1px solid var(--error-color);
        }

        .button {
            background: var(--gradient-primary);
            color: var(--text-color-bright);
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(74, 158, 255, 0.25), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .button:hover::before {
            left: 100%;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(74, 158, 255, 0.4), var(--glow-hover), inset 0 1px 0 rgba(255, 255, 255, 0.25);
        }

        .button:active {
            transform: translateY(0);
        }

        .navigation-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--gradient-primary);
            color: var(--text-color-bright);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            width: 60px;
            height: 60px;
            box-shadow: 0 6px 20px rgba(74, 158, 255, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 999;
            position: relative;
            overflow: hidden;
        }

        .navigation-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.4s ease, height 0.4s ease;
        }

        .navigation-button:hover::before {
            width: 100%;
            height: 100%;
        }

        .navigation-button:hover {
            transform: scale(1.1) rotate(180deg);
            box-shadow: 0 8px 30px rgba(74, 158, 255, 0.5), var(--glow-hover), inset 0 1px 0 rgba(255, 255, 255, 0.25);
        }

        footer {
            margin-top: 60px;
            padding: 30px 20px;
            font-size: 0.9em;
            color: #777;
            text-align: center;
            border-top: 1px solid var(--border-color);
            background: linear-gradient(180deg, transparent 0%, rgba(26, 26, 26, 0.5) 100%);
        }

        footer p {
            margin: 5px 0;
        }

        footer a {
            color: var(--highlight-color);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        footer a:hover {
            color: var(--hover-background);
            text-decoration: underline;
        }

        /* ============================================
           RESPONSIVE DESIGN - COMPREHENSIVE BREAKPOINTS
           ============================================ */

        /* Large Desktop (1400px and above) */
        @media (min-width: 1400px) {
            .main-layout {
                max-width: 1800px;
                gap: 30px;
            }

            .sidebar {
                width: 380px;
                min-width: 350px;
            }

            .feed-container {
                grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            }
        }

        /* Desktop (1025px - 1399px) - Default styles apply */
        @media (min-width: 1025px) and (max-width: 1399px) {
            .feed-container {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            }
        }

        /* Tablet Landscape (769px - 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .main-layout {
                flex-direction: column;
                width: 95%;
                gap: 20px;
            }

            .sidebar {
                width: 100%;
                position: relative;
                top: 0;
                max-height: none;
                margin-bottom: 20px;
                padding-right: 0;
            }

            .source-filters {
                max-height: 450px;
            }

            .feed-container {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 20px;
            }

            .controls-panel {
                padding: 20px;
            }

            .stats-bar {
                padding: 18px 24px;
            }
        }

        /* Tablet Portrait / Large Phone (481px - 768px) */
        @media (min-width: 481px) and (max-width: 768px) {
            .main-layout {
                width: 100%;
                margin: 12px 0;
                gap: 15px;
            }

            .sidebar {
                width: 100%;
                position: relative;
                top: 0;
                max-height: none;
                margin: 0 12px 20px 12px;
                padding-right: 0;
            }

            .source-filters-container {
                padding: 18px;
            }

            .source-filters {
                max-height: 400px;
            }

            .controls-panel {
                padding: 18px;
                margin: 0 12px 18px 12px;
            }

            .controls-row {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .search-container {
                min-width: 100%;
            }

            .feed-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                padding: 0 12px 35px 12px;
                gap: 18px;
            }

            .stats-bar {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                margin: 0 12px 18px 12px;
                padding: 16px 20px;
                gap: 15px;
            }

            .quick-actions {
                flex-wrap: wrap;
            }

            .navigation-button {
                bottom: 18px;
                right: 18px;
                width: 52px;
                height: 52px;
                font-size: 22px;
            }

            .feed-item {
                padding: 20px;
            }

            .date-filter-group {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .date-filter-group input[type="date"] {
                width: 100%;
                min-width: auto;
            }
        }

        /* Mobile / Small Phone (320px - 480px) */
        @media (max-width: 480px) {
            .main-layout {
                width: 100%;
                margin: 8px 0;
                gap: 12px;
            }

            header {
                padding: 15px 12px;
            }

            header h1 {
                font-size: 1.5em;
                margin-bottom: 6px;
            }

            header .subtitle {
                font-size: 0.8em;
                margin-bottom: 10px;
            }

            .sidebar {
                width: 100%;
                position: relative;
                top: 0;
                max-height: none;
                margin: 0 8px 15px 8px;
                padding-right: 0;
            }

            .source-filters-container {
                padding: 15px;
            }

            .source-filters-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .source-filter-actions {
                width: 100%;
                justify-content: space-between;
            }

            .source-filters {
                max-height: 350px;
            }

            .filter-presets {
                gap: 6px;
            }

            .preset-btn {
                font-size: 0.7em;
                padding: 6px 10px;
            }

            .controls-panel {
                padding: 15px;
                margin: 0 8px 15px 8px;
                border-radius: 12px;
            }

            .controls-row {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }

            .search-container {
                min-width: 100%;
            }

            .search-input {
                padding: 12px 40px 12px 15px;
                font-size: 0.9em;
            }

            .filter-select,
            .sort-select {
                width: 100%;
                padding: 12px 15px;
            }

            .feed-container {
                grid-template-columns: 1fr;
                padding: 0 8px 30px 8px;
                gap: 15px;
            }

            .feed-item {
                padding: 18px;
                border-radius: 12px;
            }

            .feed-item img,
            .feed-item .no-image {
                height: 160px;
            }

            .feed-item h2 {
                font-size: 1.1em;
            }

            .stats-bar {
                flex-direction: column;
                align-items: flex-start;
                margin: 0 8px 15px 8px;
                padding: 15px 18px;
                gap: 12px;
            }

            .stat-item {
                width: 100%;
                justify-content: space-between;
                padding: 10px 12px;
            }

            .quick-actions {
                width: 100%;
                flex-direction: column;
                gap: 10px;
            }

            .quick-action-btn {
                width: 100%;
                justify-content: center;
                padding: 12px 18px;
            }

            .auto-refresh-toggle {
                width: 100%;
                justify-content: space-between;
                padding: 10px 0;
            }

            .navigation-button {
                bottom: 15px;
                right: 15px;
                width: 48px;
                height: 48px;
                font-size: 18px;
            }

            .date-filter-group {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .date-filter-group label {
                margin-bottom: 6px;
            }

            .date-filter-group input[type="date"] {
                width: 100%;
                min-width: auto;
            }

            .customDateRange {
                flex-direction: column !important;
                gap: 10px !important;
                margin-left: 0 !important;
            }

            .button {
                width: 100%;
                padding: 14px 20px;
            }

            .source-filter-count-badge {
                font-size: 0.7em;
                padding: 3px 8px;
            }

            /* Better touch targets on mobile */
            button,
            .filter-action-btn,
            .preset-btn,
            .quick-action-btn,
            .action-btn {
                min-height: 44px;
                min-width: 44px;
            }

            .toggle-switch {
                width: 50px;
                height: 28px;
            }

            .toggle-switch::after {
                width: 22px;
                height: 22px;
            }

            .toggle-switch.active::after {
                transform: translateX(22px);
            }

            footer {
                padding: 20px 12px;
                font-size: 0.85em;
            }

            .loading {
                margin: 20px;
                padding: 20px;
            }

            .loading-progress {
                width: 100%;
                max-width: 280px;
            }

            .empty-state {
                padding: 40px 15px;
            }

            .empty-state-icon {
                font-size: 3em;
            }

            .empty-state h3 {
                font-size: 1.4em;
            }

            .empty-state p {
                font-size: 0.95em;
            }
        }

        /* Very Small Screens (max-width: 360px) */
        @media (max-width: 360px) {
            .main-layout {
                margin: 5px 0;
                gap: 10px;
            }

            header {
                padding: 12px 10px;
            }

            header h1 {
                font-size: 1.3em;
            }

            .sidebar,
            .controls-panel,
            .stats-bar {
                margin-left: 5px;
                margin-right: 5px;
            }

            .feed-container {
                padding: 0 5px 25px 5px;
                gap: 12px;
            }

            .feed-item {
                padding: 15px;
            }

            .preset-btn {
                font-size: 0.65em;
                padding: 5px 8px;
            }
        }

        /* Landscape Orientation Adjustments */
        @media (max-height: 500px) and (orientation: landscape) {
            .sidebar {
                max-height: 60vh;
            }

            .source-filters {
                max-height: 250px;
            }

            header {
                padding: 12px 20px;
            }

            header h1 {
                margin-bottom: 4px;
            }

            header .subtitle {
                margin-bottom: 8px;
            }
        }

        /* Loading skeleton */
        .skeleton {
            background: linear-gradient(90deg, var(--card-background) 25%, var(--input-background) 50%, var(--card-background) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
            height: 20px;
            margin: 10px 0;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        kbd {
            background: var(--input-background);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 4px 8px;
            font-family: monospace;
            font-size: 0.85em;
            color: var(--highlight-color);
        }

        /* Scrollbar styling */
        .source-filters::-webkit-scrollbar,
        .category-content::-webkit-scrollbar {
            width: 8px;
        }

        .source-filters::-webkit-scrollbar-track,
        .category-content::-webkit-scrollbar-track {
            background: var(--card-background);
            border-radius: 4px;
        }

        .source-filters::-webkit-scrollbar-thumb,
        .category-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--highlight-color), var(--hover-background));
            border-radius: 4px;
        }

        .source-filters::-webkit-scrollbar-thumb:hover,
        .category-content::-webkit-scrollbar-thumb:hover {
            background: var(--hover-background);
        }

        .date-filter-group {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px;
            width: 100%;
        }

        .date-filter-group input[type="date"] {
            background: var(--input-background);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 0.9em;
            padding: 8px 12px;
        }

        .date-filter-group input[type="date"]:focus {
            outline: none;
            border-color: var(--highlight-color);
            box-shadow: 0 0 0 3px rgba(0, 229, 255, 0.1);
        }

        .date-filter-group input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0.8);
            cursor: pointer;
        }

        /* Improved empty state styling */
        .empty-state {
            animation: fadeIn 0.5s ease;
        }

        .empty-state-icon {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.7;
            animation: pulse 2s ease-in-out infinite;
        }

        /* Better error message styling */
        .error-message {
            animation: slideIn 0.3s ease;
            border-left: 4px solid var(--error-color);
        }

        /* Improved loading state */
        .loading {
            animation: fadeIn 0.3s ease;
        }

        /* Screen reader only text */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Improved stat items for better readability */
        .stat-item {
            padding: 8px 12px;
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.08), rgba(90, 170, 255, 0.05));
            border-radius: 8px;
            border: 1px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.05);
            position: relative;
        }

        .stat-item:hover {
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.15), rgba(90, 170, 255, 0.1));
            border-color: var(--highlight-color);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(74, 158, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .stat-item[title]:hover::after {
            content: attr(title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-background);
            color: var(--text-color);
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.75em;
            white-space: nowrap;
            margin-bottom: 5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            z-index: 1000;
            pointer-events: none;
        }

        /* Better visual hierarchy for source filter count */
        .source-filter-count-badge {
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.2), rgba(90, 170, 255, 0.15));
            color: var(--highlight-color);
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: 8px;
            border: 1px solid rgba(74, 158, 255, 0.4);
            box-shadow: 0 2px 6px rgba(74, 158, 255, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
            cursor: help;
        }

        .source-filter-count-badge:hover {
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.3), rgba(90, 170, 255, 0.25));
            transform: scale(1.05);
        }

        /* Improved button states */
        .button:disabled,
        .quick-action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* Better contrast for links */
        .feed-item a:focus-visible {
            outline: 3px solid var(--highlight-color);
            outline-offset: 4px;
            border-radius: 4px;
        }

        /* Better visual feedback for active filters */
        .filter-select:not([value="all"]),
        .sort-select:not([value="date-desc"]) {
            border-color: var(--highlight-color);
            background: rgba(74, 158, 255, 0.05);
        }

        /* Active search indicator */
        .search-input:not(:placeholder-shown) {
            border-color: var(--highlight-color);
            background: rgba(74, 158, 255, 0.03);
        }

        /* Better visual indication of active filters */
        .preset-btn.active {
            background: rgba(74, 158, 255, 0.2);
            border-color: var(--highlight-color);
            color: var(--highlight-color);
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(74, 158, 255, 0.2);
        }

        /* Improved accessibility for toggle switch */
        .auto-refresh-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .auto-refresh-toggle label {
            cursor: pointer;
            user-select: none;
        }

        /* Better date input styling */
        .date-filter-group input[type="date"] {
            min-width: 140px;
        }

        /* Improved notification styling */
        @keyframes slideInFromTop {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Welcome banner / Tips */
        .welcome-banner {
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.12), rgba(90, 170, 255, 0.08));
            border: 1.5px solid var(--highlight-color);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            animation: slideInFromTop 0.4s ease;
            box-shadow: 0 4px 16px rgba(74, 158, 255, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .welcome-banner::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-primary);
        }

        .welcome-banner.hidden {
            display: none;
        }

        .welcome-banner-icon {
            font-size: 1.5em;
            flex-shrink: 0;
        }

        .welcome-banner-content {
            flex: 1;
        }

        .welcome-banner-title {
            font-weight: 600;
            color: var(--text-color-bright);
            margin-bottom: 6px;
            font-size: 0.95em;
        }

        .welcome-banner-text {
            font-size: 0.85em;
            color: var(--text-color);
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .welcome-banner-text kbd {
            background: rgba(74, 158, 255, 0.2);
            border: 1px solid rgba(74, 158, 255, 0.4);
            border-radius: 4px;
            padding: 2px 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: var(--highlight-color);
            font-weight: 600;
        }

        .welcome-banner-close {
            background: transparent;
            border: none;
            color: var(--text-color);
            font-size: 1.2em;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .welcome-banner-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--highlight-color);
        }

        /* Search hints */
        .search-hint {
            font-size: 0.75em;
            color: #777;
            margin-top: 6px;
            padding-left: 4px;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .search-container:focus-within .search-hint {
            display: block;
        }

        /* Input validation states */
        input:invalid {
            border-color: var(--error-color);
        }

        input:valid:not(:placeholder-shown) {
            border-color: var(--success-color);
        }

        /* Better visual feedback for disabled states */
        button:disabled,
        input:disabled,
        select:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        /* Loading state for buttons */
        .button.loading,
        .quick-action-btn.loading {
            position: relative;
            color: transparent;
        }

        .button.loading::after,
        .quick-action-btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            margin: -8px 0 0 -8px;
            border: 2px solid var(--text-color-bright);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        /* Quick tips */
        .quick-tips {
            background: var(--card-background);
            border-radius: 10px;
            padding: 12px 16px;
            margin-top: 15px;
            border: 1px solid var(--border-color);
        }

        .quick-tips-title {
            font-size: 0.8em;
            font-weight: 600;
            color: var(--text-color-bright);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .quick-tips-list {
            font-size: 0.75em;
            color: var(--text-color);
            line-height: 1.6;
            padding-left: 18px;
        }

        .quick-tips-list li {
            margin-bottom: 4px;
        }

        /* Better empty state */
        .empty-state-help {
            margin-top: 20px;
            padding: 15px;
            background: rgba(74, 158, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(74, 158, 255, 0.2);
        }

        .empty-state-help-title {
            font-weight: 600;
            color: var(--highlight-color);
            margin-bottom: 8px;
            font-size: 0.9em;
        }

        .empty-state-help-text {
            font-size: 0.85em;
            color: var(--text-color);
            line-height: 1.6;
        }

        .empty-state-help-text ul {
            list-style-type: disc;
        }

        .empty-state-help-text li {
            margin-bottom: 6px;
        }

        /* Refresh button in header */
        .header-actions {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .refresh-btn {
            background: rgba(74, 158, 255, 0.1);
            border: 1.5px solid var(--highlight-color);
            color: var(--highlight-color);
            padding: 8px 14px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 8px rgba(74, 158, 255, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .refresh-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .refresh-btn:hover::before {
            left: 100%;
        }

        .refresh-btn:hover {
            background: var(--gradient-primary);
            color: var(--text-color-bright);
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(74, 158, 255, 0.3), var(--glow-primary), inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .refresh-btn:active {
            transform: translateY(0);
        }

        .refresh-btn.loading {
            opacity: 0.6;
            cursor: wait;
        }

        .refresh-btn.loading .refresh-icon {
            animation: spin 1s linear infinite;
        }

        @media (max-width: 768px) {
            .header-actions {
                position: static;
                justify-content: center;
                margin-top: 10px;
            }

            .welcome-banner {
                padding: 12px 16px;
                margin: 0 10px 15px 10px;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-to-content">Skip to main content</a>
    <header role="banner">
        <h1>üõ°Ô∏è Stay Updated</h1>
        <p class="subtitle">Real-time Cybersecurity Threat Intelligence Aggregator</p>
        <div class="last-updated" id="lastUpdated"></div>
        <div class="header-actions">
            <button class="refresh-btn" id="headerRefreshBtn" title="Refresh all feeds" aria-label="Refresh all feeds">
                <span class="refresh-icon">üîÑ</span>
                <span>Refresh</span>
            </button>
        </div>
    </header>

    <div class="main-layout">
        <!-- Left Sidebar: Source Filters -->
        <aside class="sidebar">
            <div class="source-filters-container">
                <div class="source-filters-header">
                    <div class="source-filters-title">
                        <span>üì∞</span>
                        <span>Filter by Source</span>
                        <span class="source-filter-count-badge" id="sourceFilterCount">0 selected</span>
                    </div>
                    <div class="source-filter-actions">
                        <button class="filter-action-btn" id="selectAllSources" title="Select all available sources" aria-label="Select all available sources">
                            <span>‚úì</span> <span>All</span>
                        </button>
                        <button class="filter-action-btn" id="deselectAllSources" title="Deselect all sources" aria-label="Deselect all sources">
                            <span>‚úó</span> <span>None</span>
                        </button>
                    </div>
                </div>
                
                <div class="filter-presets">
                    <div style="font-size: 0.85em; color: #777; margin-right: 10px; font-weight: 700; width: 100%; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.5px;">Quick Filters</div>
                    <button class="preset-btn" data-preset="government" title="Government & Critical Infrastructure sources">
                        üèõÔ∏è Government
                    </button>
                    <button class="preset-btn" data-preset="news" title="Breaking news & journalism">
                        üïµÔ∏è News
                    </button>
                    <button class="preset-btn" data-preset="research" title="Threat research & malware analysis">
                        üî¨ Research
                    </button>
                    <button class="preset-btn" data-preset="offensive" title="Offensive security & hacking">
                        üõ°Ô∏è Offensive
                    </button>
                    <button class="preset-btn" data-preset="bugbounty" title="Bug bounty programs & writeups">
                        üéØ Bug Bounty
                    </button>
                    <button class="preset-btn" data-preset="cloud" title="Cloud & platform security">
                        ‚òÅÔ∏è Cloud
                    </button>
                    <button class="preset-btn" data-preset="community" title="Community forums & discussions">
                        üë• Community
                    </button>
                </div>
                
                <div class="source-search-wrapper">
                    <label for="sourceSearch" class="sr-only">Search sources</label>
                    <input type="text" 
                           class="source-search" 
                           id="sourceSearch" 
                           placeholder="Search sources..."
                           aria-label="Search sources"
                           aria-describedby="sourceSearchHelp"
                           autocomplete="off"
                           spellcheck="false">
                    <span class="source-search-icon" aria-hidden="true">üîç</span>
                    <span id="sourceSearchHelp" class="sr-only">Type to filter the list of available sources</span>
                </div>
                
                <div class="source-filter-actions" style="margin-top: 16px; margin-bottom: 16px; justify-content: space-between; border-top: 1px solid var(--border-color); padding-top: 12px;">
                    <button class="filter-action-btn" id="expandAllCategories" title="Expand all categories" aria-label="Expand all categories">
                        <span>‚ñº</span> <span>Expand All</span>
                    </button>
                    <button class="filter-action-btn" id="collapseAllCategories" title="Collapse all categories" aria-label="Collapse all categories">
                        <span>‚ñ≤</span> <span>Collapse All</span>
                    </button>
                </div>
                
                <div class="source-filters" id="sourceFilters" role="group" aria-label="Filter by source">
                    <!-- Source categories will be dynamically generated -->
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content" id="main-content" tabindex="-1">
            <!-- Welcome Banner -->
            <div class="welcome-banner" id="welcomeBanner">
                <div class="welcome-banner-icon">üí°</div>
                <div class="welcome-banner-content">
                    <div class="welcome-banner-title">Quick Start Guide</div>
                    <div class="welcome-banner-text">
                        <strong>Welcome!</strong> This page aggregates cybersecurity news from 55+ trusted sources. 
                        <strong>Quick tips:</strong> Use filter buttons for topics, search with keywords, or click article cards to read. 
                        Press <kbd>/</kbd> to focus search. Your preferences are saved automatically.
                    </div>
                </div>
                <button class="welcome-banner-close" id="closeWelcomeBanner" aria-label="Close welcome message">√ó</button>
            </div>

            <div class="controls-panel">
                <div class="controls-row">
                    <div class="search-container">
                        <label for="searchInput" class="sr-only">Search articles</label>
                        <input type="text" 
                               class="search-input" 
                               id="searchInput" 
                               placeholder="Search articles by title, description, or source... (Press / to focus)"
                               aria-label="Search feeds"
                               aria-describedby="searchHelp"
                               autocomplete="off"
                               spellcheck="false">
                        <span class="search-icon" aria-hidden="true">üîç</span>
                        <div id="searchHelp" class="search-hint">üí° Tip: Try searching for keywords like "ransomware", "vulnerability", or source names</div>
                    </div>
                    <label for="sortSelect" class="sr-only">Sort articles by</label>
                    <select class="sort-select" id="sortSelect" aria-label="Sort feeds" aria-describedby="sortHelp">
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="source">By Source</option>
                    </select>
                    <span id="sortHelp" class="sr-only">Choose how to sort the articles</span>
                </div>
                <div class="controls-row">
                    <div class="date-filter-group">
                        <label for="dateFilter" style="font-size: 0.85em; color: #b3b3b3; margin-right: 10px; font-weight: 500;">Date Range:</label>
                        <select class="filter-select" id="dateFilter" aria-label="Filter by date" aria-describedby="dateFilterHelp">
                            <option value="all">All Time</option>
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="custom">Custom Range</option>
                        </select>
                        <span id="dateFilterHelp" class="sr-only">Select a date range to filter articles</span>
                        <div id="customDateRange" style="display: none; gap: 10px; align-items: center; margin-left: 10px;">
                            <label for="dateFrom" class="sr-only">Start date</label>
                            <input type="date" 
                                   id="dateFrom" 
                                   class="filter-select" 
                                   style="padding: 8px;" 
                                   aria-label="Date from"
                                   aria-describedby="dateRangeHelp"
                                   max="">
                            <span style="color: #777; font-weight: 500;">to</span>
                            <label for="dateTo" class="sr-only">End date</label>
                            <input type="date" 
                                   id="dateTo" 
                                   class="filter-select" 
                                   style="padding: 8px;" 
                                   aria-label="Date to"
                                   aria-describedby="dateRangeHelp"
                                   max="">
                            <span id="dateRangeHelp" class="sr-only">Select start and end dates for custom range</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="stats-bar">
                <div style="display: flex; gap: 20px; flex-wrap: wrap; align-items: center;">
                    <div class="stat-item" title="Total number of articles loaded from all sources">
                        <span>üìä Total:</span>
                        <span class="stat-value" id="totalCount">0</span>
                    </div>
                    <div class="stat-item" title="Number of articles currently visible after applying filters">
                        <span>üëÅÔ∏è Showing:</span>
                        <span class="stat-value" id="showingCount">0</span>
                    </div>
                    <div class="stat-item" title="Number of unique sources with articles">
                        <span>üì∞ Sources:</span>
                        <span class="stat-value" id="sourceCount">0</span>
                    </div>
                </div>
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div class="auto-refresh-toggle">
                        <label for="autoRefreshToggle" style="cursor: pointer; user-select: none;" title="Automatically refresh feeds every 30 minutes">
                            <span>üîÑ Auto-refresh:</span>
                        </label>
                        <div class="toggle-switch" 
                             id="autoRefreshToggle" 
                             role="switch" 
                             aria-checked="false"
                             aria-label="Toggle auto-refresh"
                             aria-describedby="autoRefreshHelp"
                             tabindex="0"></div>
                        <span id="refreshInterval" aria-live="polite">30 min</span>
                        <span id="autoRefreshHelp" class="sr-only">When enabled, feeds will automatically refresh every 30 minutes</span>
                    </div>
                    <div class="quick-actions">
                        <button class="quick-action-btn" id="exportBtn" title="Export filtered articles to JSON file" aria-label="Export filtered articles">
                            üíæ Export
                        </button>
                        <button class="quick-action-btn" id="clearFiltersBtn" title="Clear all filters and reset to default view" aria-label="Clear all filters">
                            üóëÔ∏è Clear Filters
                        </button>
                        <button class="quick-action-btn" id="helpBtn" title="View keyboard shortcuts and tips" aria-label="Show keyboard shortcuts help">
                            ‚å®Ô∏è Help
                        </button>
                    </div>
                </div>
            </div>

            <div class="loading" id="loadingMessage" style="display: none;" role="status" aria-live="polite" aria-label="Loading feeds">
                <div class="spinner" aria-hidden="true"></div>
                <span style="font-weight: 500;">Loading threat intelligence feeds...</span>
                <div class="loading-progress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Loading progress">
                    <div class="loading-progress-bar" id="loadingProgress" style="width: 0%;"></div>
                </div>
                <div style="font-size: 0.85em; color: #777; margin-top: 8px;" id="loadingStatus" aria-live="polite">Initializing...</div>
                <div style="font-size: 0.75em; color: #666; margin-top: 12px; max-width: 400px; text-align: center;">
                    üí° Tip: Cached articles load instantly. Fresh data loads in the background.
                </div>
            </div>

            <div class="error-message" id="errorMessage" style="display: none;" role="alert" aria-live="assertive"></div>

            <div class="feed-container" id="feedContainer" role="main" aria-live="polite">
                <!-- RSS feed content will be dynamically loaded here -->
            </div>

            <button class="button" id="retryButton" style="display: none; margin: 20px auto;" aria-label="Retry loading feeds">Retry Loading Feeds</button>
        </main>
    </div>

    <footer role="contentinfo">
        <p>&copy; 2026 ashizZz | Cybersecurity Threat Intelligence Aggregator</p>
        <p style="font-size: 0.85em; margin-top: 5px;">Stay informed. Stay secure.</p>
    </footer>

    <button class="navigation-button" id="toggleButton" aria-label="Scroll to top or bottom">
        <span id="arrowIcon">‚Üë</span>
    </button>

    <script>
        // Configuration
        const CONFIG = {
            CACHE_DURATION: 30 * 60 * 1000, // 30 minutes
            AUTO_REFRESH_INTERVAL: 30 * 60 * 1000, // 30 minutes
            MAX_ITEMS_PER_FEED: 10,
            PROXY_URL: "https://api.rss2json.com/v1/api.json?rss_url=",
            FETCH_TIMEOUT: 15000, // 15 seconds per feed
            CONCURRENT_FEEDS: 10, // Load 10 feeds at a time
            USE_CACHE_FIRST: true // Show cached feeds immediately
        };

        const rssFeeds = [
            // üèõÔ∏è Government & Critical Infrastructure
            { url: "https://www.cisa.gov/cybersecurity-advisories/all.xml", name: "CISA Advisories" },
            { url: "https://www.cisa.gov/news.xml", name: "CISA News" },
            { url: "https://www.ncsc.gov.uk/api/1/services/v1/all-rss-feed.xml", name: "NCSC (UK)" },
            { url: "https://www.kb.cert.org/vulfeed/", name: "CERT Vulnerability Notes" },
            { url: "https://www.nist.gov/blogs/cybersecurity-insights/rss.xml", name: "NIST Cybersecurity Insights" },
            { url: "https://www.us-cert.gov/ncas/alerts.xml", name: "US-CERT Alerts" },
            
            // üïµÔ∏è Investigative Journalism & Breaking News
            { url: "https://krebsonsecurity.com/feed/", name: "Krebs on Security" },
            { url: "https://feeds.feedburner.com/TheHackersNews", name: "The Hacker News" },
            { url: "https://www.darkreading.com/rss.xml", name: "Dark Reading" },
            { url: "https://www.bleepingcomputer.com/feed/", name: "BleepingComputer" },
            { url: "https://www.schneier.com/feed/atom/", name: "Schneier on Security" },
            { url: "https://risky.biz/feeds/risky-business", name: "Risky Business" },
            { url: "https://www.grahamcluley.com/feed/", name: "Graham Cluley" },
            { url: "https://www.securityweek.com/rss", name: "SecurityWeek" },
            { url: "https://www.helpnetsecurity.com/feed", name: "Help Net Security" },
            { url: "https://securityaffairs.co/wordpress/feed", name: "Security Affairs" },
            { url: "https://www.cybersecuritynews.com/feed/", name: "Cyber Security News" },
            { url: "https://www.hackread.com/feed", name: "HackRead" },
            
            // üî¨ Threat Research & Malware Analysis
            { url: "https://googleprojectzero.blogspot.com/feeds/posts/default?alt=rss", name: "Google Project Zero" },
            { url: "https://talosintelligence.com/rss", name: "Cisco Talos Intelligence" },
            { url: "https://isc.sans.edu/rssfeed_full.xml", name: "SANS Internet Storm Center" },
            { url: "https://www.mandiant.com/resources/blog/rss.xml", name: "Mandiant" },
            { url: "https://securelist.com/feed/", name: "Securelist (Kaspersky)" },
            { url: "https://news.sophos.com/en-us/category/threat-research/feed/", name: "Sophos Threat Research" },
            { url: "https://www.malwarebytes.com/blog/feed", name: "Malwarebytes Labs" },
            { url: "https://research.checkpoint.com/feed", name: "Check Point Research" },
            { url: "https://unit42.paloaltonetworks.com/feed", name: "Palo Alto Unit 42" },
            { url: "https://www.welivesecurity.com/feed", name: "WeLiveSecurity" },
            { url: "https://www.crowdstrike.com/blog/feed", name: "CrowdStrike Blog" },
            { url: "https://blog.google/threat-analysis-group/rss", name: "Google TAG" },
            { url: "https://blog.trailofbits.com/feed/", name: "Trail of Bits" },
            { url: "https://www.zerodayinitiative.com/blog?format=rss", name: "Zero Day Initiative" },
            
            // üõ°Ô∏è Offensive Security & Hacking Techniques
            { url: "https://www.offsec.com/blog/feed", name: "OffSec (Offensive Security)" },
            { url: "https://www.offensive-security.com/blog/feed", name: "Offensive Security" },
            { url: "https://bishopfox.com/feeds/blog.rss", name: "Bishop Fox" },
            { url: "https://hackingthe.cloud/feed_rss_created.xml", name: "Hacking The Cloud" },
            { url: "https://www.hackthebox.com/rss/blog/all", name: "Hack The Box (All)" },
            { url: "https://www.hackthebox.com/rss/blog/blue-teaming", name: "HackTheBox Blue Team" },
            { url: "http://feeds.feedburner.com/PentestTools", name: "KitPloit" },
            { url: "https://malwaretech.com/feed.xml", name: "MalwareTech" },
            { url: "https://aboutdfir.com/feed", name: "About DFIR" },
            { url: "https://infosecwriteups.com/feed", name: "InfoSec Writeups" },
            
            // ‚òÅÔ∏è Platform & Cloud Security
            { url: "https://aws.amazon.com/blogs/security/feed/", name: "AWS Security Blog" },
            { url: "https://msrc-blog.microsoft.com/feed", name: "Microsoft Security Response Center" },
            { url: "https://www.microsoft.com/security/blog/feed", name: "Microsoft Security Blog" },
            
            // üîß Security Operations & Tools
            { url: "https://news.sophos.com/en-us/category/security-operations/feed/", name: "Sophos Security Ops" },
            { url: "https://nakedsecurity.sophos.com/feed", name: "Naked Security" },
            
            // üë• Community & Forums
            { url: "https://www.reddit.com/r/netsec/.rss", name: "r/netsec" },
            { url: "https://www.reddit.com/r/blueteamsec/.rss", name: "r/blueteamsec" },
            { url: "https://news.ycombinator.com/rss", name: "Hacker News" },
            
            // üéØ Bug Bounty & Responsible Disclosure
            { url: "https://medium.com/feed/bugbountywriteup/tagged/bug-bounty", name: "Bug Bounty Writeups (Medium)" },
            { url: "https://medium.com/feed/tag/bug-bounty", name: "Medium Bug Bounty Tag" },
            { url: "https://www.intigriti.com/blog/feed", name: "Intigriti Blog" },
            { url: "https://www.yeswehack.com/rss.xml", name: "YesWeHack" },
            { url: "https://www.hackerone.com/blog/feed", name: "HackerOne Blog" }
        ];

        // State management
        const state = {
            allItems: [],
            filteredItems: [],
            selectedSources: new Set(),
            searchQuery: '',
            sortBy: 'date-desc',
            dateFilter: 'all',
            dateFrom: null,
            dateTo: null,
            autoRefreshEnabled: false,
            refreshTimer: null,
            feedStatus: {}
        };

        // DOM elements
        const elements = {
            feedContainer: document.getElementById('feedContainer'),
            lastUpdated: document.getElementById('lastUpdated'),
            loadingMessage: document.getElementById('loadingMessage'),
            errorMessage: document.getElementById('errorMessage'),
            retryButton: document.getElementById('retryButton'),
            toggleButton: document.getElementById('toggleButton'),
            arrowIcon: document.getElementById('arrowIcon'),
            searchInput: document.getElementById('searchInput'),
            sortSelect: document.getElementById('sortSelect'),
            dateFilter: document.getElementById('dateFilter'),
            dateFrom: document.getElementById('dateFrom'),
            dateTo: document.getElementById('dateTo'),
            customDateRange: document.getElementById('customDateRange'),
            sourceFilters: document.getElementById('sourceFilters'),
            sourceSearch: document.getElementById('sourceSearch'),
            sourceFilterCount: document.getElementById('sourceFilterCount'),
            selectAllSources: document.getElementById('selectAllSources'),
            deselectAllSources: document.getElementById('deselectAllSources'),
            expandAllCategories: document.getElementById('expandAllCategories'),
            collapseAllCategories: document.getElementById('collapseAllCategories'),
            exportBtn: document.getElementById('exportBtn'),
            clearFiltersBtn: document.getElementById('clearFiltersBtn'),
            helpBtn: document.getElementById('helpBtn'),
            loadingProgress: document.getElementById('loadingProgress'),
            loadingStatus: document.getElementById('loadingStatus'),
            totalCount: document.getElementById('totalCount'),
            showingCount: document.getElementById('showingCount'),
            sourceCount: document.getElementById('sourceCount'),
            autoRefreshToggle: document.getElementById('autoRefreshToggle'),
            refreshInterval: document.getElementById('refreshInterval')
        };

        // Utility functions
        function sanitizeHtml(html) {
            if (!html) return "";
            try {
                const template = document.createElement('template');
                template.innerHTML = html;
                return template.content.textContent || "";
            } catch (e) {
                // Fallback for invalid HTML
                return String(html).replace(/<[^>]*>/g, '');
            }
        }

        function getRelativeTime(date) {
            try {
                const now = new Date();
                const itemDate = new Date(date);
                
                // Handle invalid dates
                if (isNaN(itemDate.getTime())) {
                    return 'Date unknown';
                }
                
                // Handle future dates
                if (itemDate > now) {
                    return 'Just now';
                }
                
                const diff = now - itemDate;
                const seconds = Math.floor(diff / 1000);
                const minutes = Math.floor(seconds / 60);
                const hours = Math.floor(minutes / 60);
                const days = Math.floor(hours / 24);

                if (days > 7) return itemDate.toLocaleDateString();
                if (days > 0) return `${days} day${days > 1 ? 's' : ''} ago`;
                if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} ago`;
                if (minutes > 0) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
                return 'Just now';
            } catch (e) {
                return 'Date unknown';
            }
        }

        function estimateReadingTime(text) {
            if (!text) return null;
            const wordsPerMinute = 200;
            const wordCount = text.split(/\s+/).length;
            const minutes = Math.ceil(wordCount / wordsPerMinute);
            return minutes <= 1 ? '1 min read' : `${minutes} min read`;
        }

        function copyToClipboard(text, message) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification(message || 'Copied to clipboard!');
            }).catch(() => {
                // Fallback
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showNotification(message || 'Copied to clipboard!');
            });
        }

        function shareArticle(item) {
            if (navigator.share) {
                navigator.share({
                    title: item.title,
                    text: item.description || '',
                    url: item.link
                }).catch(() => {});
            } else {
                copyToClipboard(item.link, 'Article link copied!');
            }
        }

        // Enhanced notification system with types and better UX
        function showNotification(message, type = 'info', duration = 3000) {
            // Remove existing notifications to prevent stacking
            const existingNotifications = document.querySelectorAll('.notification-toast');
            existingNotifications.forEach(n => {
                n.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => n.remove(), 300);
            });

            const notification = document.createElement('div');
            notification.className = 'notification-toast';
            notification.setAttribute('role', 'alert');
            notification.setAttribute('aria-live', type === 'error' ? 'assertive' : 'polite');
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                warning: '‚ö†Ô∏è',
                info: '‚ÑπÔ∏è'
            };
            
            const colors = {
                success: 'var(--success-color)',
                error: 'var(--error-color)',
                warning: 'var(--warning-color)',
                info: 'var(--highlight-color)'
            };
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--gradient-card);
                color: var(--text-color);
                padding: 16px 20px;
                border-radius: 12px;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4), 0 0 0 1px ${colors[type]}, inset 0 1px 0 rgba(255, 255, 255, 0.1);
                border: 1.5px solid ${colors[type]};
                z-index: 10000;
                animation: slideInFromTop 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                max-width: 400px;
                display: flex;
                align-items: center;
                gap: 12px;
                font-weight: 500;
            `;
            
            notification.innerHTML = `
                <span style="font-size: 1.2em; flex-shrink: 0;">${icons[type] || icons.info}</span>
                <span style="flex: 1;">${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-dismiss
            const timeout = setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, duration);
            
            // Allow manual dismiss on click
            notification.style.cursor = 'pointer';
            notification.addEventListener('click', () => {
                clearTimeout(timeout);
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            });
            
            // Add hover effect
            notification.addEventListener('mouseenter', () => {
                notification.style.transform = 'translateY(-2px)';
                notification.style.boxShadow = `0 12px 32px rgba(0, 0, 0, 0.5), 0 0 0 1px ${colors[type]}, inset 0 1px 0 rgba(255, 255, 255, 0.15)`;
            });
            
            notification.addEventListener('mouseleave', () => {
                notification.style.transform = 'translateY(0)';
                notification.style.boxShadow = `0 8px 24px rgba(0, 0, 0, 0.4), 0 0 0 1px ${colors[type]}, inset 0 1px 0 rgba(255, 255, 255, 0.1)`;
            });
        }

        function extractSourceName(item) {
            try {
                if (item.link) {
                    const hostname = new URL(item.link).hostname.replace('www.', '');
                    return hostname.split('.')[0].charAt(0).toUpperCase() + hostname.split('.')[0].slice(1);
                }
            } catch (e) {
                // Fallback to feed name if available
            }
            return 'Unknown';
        }

        function extractImageUrl(item) {
            try {
                if (item.enclosure && item.enclosure.link) {
                    const url = item.enclosure.link;
                    // Validate URL
                    try {
                        new URL(url);
                        return url;
                    } catch {
                        // Invalid URL
                    }
                }
                if (item.thumbnail) {
                    try {
                        new URL(item.thumbnail);
                        return item.thumbnail;
                    } catch {
                        // Invalid URL
                    }
                }
                
                // Try to extract from description
                const desc = item.description || '';
                const imgMatch = desc.match(/<img[^>]+src=["']([^"']+)["']/i);
                if (imgMatch && imgMatch[1]) {
                    try {
                        new URL(imgMatch[1]);
                        return imgMatch[1];
                    } catch {
                        // Invalid URL
                    }
                }
            } catch (e) {
                // Silently fail
            }
            
            return null;
        }

        // Storage management
        function saveToStorage(key, data) {
            try {
                localStorage.setItem(key, JSON.stringify({
                    data,
                    timestamp: Date.now()
                }));
            } catch (e) {
                // Handle quota exceeded or other storage errors gracefully
                if (e.name === 'QuotaExceededError') {
                    // Clear old cache if storage is full
                    try {
                        const keys = Object.keys(localStorage);
                        keys.filter(k => k.startsWith('feed_')).forEach(k => {
                            const item = localStorage.getItem(k);
                            if (item) {
                                try {
                                    const parsed = JSON.parse(item);
                                    const age = Date.now() - parsed.timestamp;
                                    if (age > CONFIG.CACHE_DURATION) {
                                        localStorage.removeItem(k);
                                    }
                                } catch {}
                            }
                        });
                        // Retry once
                        localStorage.setItem(key, JSON.stringify({
                            data,
                            timestamp: Date.now()
                        }));
                    } catch (retryError) {
                        // Silently fail - cache is not critical
                        if (window.location.hostname === 'localhost') {
                            console.warn('Failed to save to localStorage after cleanup:', retryError);
                        }
                    }
                } else if (window.location.hostname === 'localhost') {
                    console.warn('Failed to save to localStorage:', e);
                }
            }
        }

        function loadFromStorage(key) {
            try {
                const stored = localStorage.getItem(key);
                if (!stored) return null;
                
                const parsed = JSON.parse(stored);
                const age = Date.now() - parsed.timestamp;
                
                if (age > CONFIG.CACHE_DURATION) {
                    localStorage.removeItem(key);
                    return null;
                }
                
                return parsed.data;
            } catch (e) {
                // Silently handle corrupted data
                try {
                    localStorage.removeItem(key);
                } catch {}
                if (window.location.hostname === 'localhost') {
                    console.warn('Failed to load from localStorage:', e);
                }
                return null;
            }
        }

        function loadPreferences() {
            const prefs = loadFromStorage('feedPreferences');
            if (prefs) {
                state.selectedSources = new Set(prefs.selectedSources || []);
                state.sortBy = prefs.sortBy || 'date-desc';
                state.dateFilter = prefs.dateFilter || 'all';
                state.dateFrom = prefs.dateFrom || null;
                state.dateTo = prefs.dateTo || null;
                state.autoRefreshEnabled = prefs.autoRefreshEnabled || false;
                state.expandedCategories = new Set(prefs.expandedCategories || []);
                
                elements.sortSelect.value = state.sortBy;
                elements.dateFilter.value = state.dateFilter;
                if (state.dateFilter === 'custom') {
                    elements.customDateRange.style.display = 'flex';
                    if (state.dateFrom) elements.dateFrom.value = state.dateFrom;
                    if (state.dateTo) elements.dateTo.value = state.dateTo;
                }
                elements.autoRefreshToggle.classList.toggle('active', state.autoRefreshEnabled);
                elements.autoRefreshToggle.setAttribute('aria-checked', state.autoRefreshEnabled);
            }
        }

        function savePreferences() {
            saveToStorage('feedPreferences', {
                selectedSources: Array.from(state.selectedSources),
                sortBy: state.sortBy,
                dateFilter: state.dateFilter,
                dateFrom: state.dateFrom,
                dateTo: state.dateTo,
                autoRefreshEnabled: state.autoRefreshEnabled,
                expandedCategories: Array.from(state.expandedCategories)
            });
        }

        // Feed fetching
        // Fetch with timeout
        async function fetchWithTimeout(url, timeout = CONFIG.FETCH_TIMEOUT) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeout);
            
            try {
                const response = await fetch(url, { 
                    signal: controller.signal,
                    cache: 'no-cache'
                });
                clearTimeout(timeoutId);
                return response;
            } catch (error) {
                clearTimeout(timeoutId);
                if (error.name === 'AbortError') {
                    throw new Error('Request timeout');
                }
                throw error;
            }
        }

        // Safe cache key generation
        function getCacheKey(url) {
            try {
                // Use btoa for ASCII-safe URLs, fallback to encoded string
                return `feed_${btoa(url).replace(/[+/=]/g, '')}`;
            } catch (e) {
                // Fallback for URLs with special characters
                return `feed_${encodeURIComponent(url).replace(/[^a-zA-Z0-9]/g, '_')}`;
            }
        }

        async function fetchFeed(feedConfig, useCache = true) {
            const cacheKey = getCacheKey(feedConfig.url);
            const cached = loadFromStorage(cacheKey);
            
            // Return cached data immediately if available and using cache
            if (useCache && cached) {
                return { ...cached, source: feedConfig.name, cached: true };
            }

            try {
                const response = await fetchWithTimeout(
                    `${CONFIG.PROXY_URL}${encodeURIComponent(feedConfig.url)}`,
                    CONFIG.FETCH_TIMEOUT
                );
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                
                if (data.status === 'ok' && data.items) {
                    const feedData = {
                        status: 'ok',
                        items: data.items.slice(0, CONFIG.MAX_ITEMS_PER_FEED),
                        source: feedConfig.name,
                        url: feedConfig.url,
                        cached: false
                    };
                    
                    saveToStorage(cacheKey, feedData);
                    state.feedStatus[feedConfig.name] = 'success';
                    return feedData;
                } else {
                    throw new Error('Invalid feed response');
                }
            } catch (error) {
                // Only log errors in development
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    console.error(`Error fetching feed: ${feedConfig.name}`, error);
                }
                state.feedStatus[feedConfig.name] = 'error';
                
                // Return cached data as fallback if available
                if (cached) {
                    return { ...cached, source: feedConfig.name, cached: true, fallback: true };
                }
                
                return {
                    status: 'error',
                    source: feedConfig.name,
                    url: feedConfig.url,
                    error: error.message
                };
            }
        }

        // Process feed result and update UI immediately
        let filterUpdateTimer = null;
        function processFeedResult(result, updateUI = true) {
            if (result && result.status === 'ok' && Array.isArray(result.items)) {
                try {
                    result.items.forEach(item => {
                        if (item && item.title) { // Only process valid items
                            state.allItems.push({
                                ...item,
                                sourceName: result.source || 'Unknown',
                                sourceUrl: result.url || '',
                                pubDate: (() => {
                                    try {
                                        const date = new Date(item.pubDate);
                                        return isNaN(date.getTime()) ? new Date() : date;
                                    } catch {
                                        return new Date();
                                    }
                                })()
                            });
                        }
                    });
                    
                    // Debounce UI updates to avoid excessive re-renders
                    if (updateUI && state.allItems.length > 0) {
                        clearTimeout(filterUpdateTimer);
                        filterUpdateTimer = setTimeout(() => {
                            applyFilters();
                        }, 100); // Update UI every 100ms max
                    }
                } catch (e) {
                    // Silently handle processing errors
                    if (window.location.hostname === 'localhost') {
                        console.warn('Error processing feed result:', e);
                    }
                }
            }
        }

        // Batch processing with concurrency control
        async function processBatch(feeds, batchSize = CONFIG.CONCURRENT_FEEDS) {
            const batches = [];
            for (let i = 0; i < feeds.length; i += batchSize) {
                batches.push(feeds.slice(i, i + batchSize));
            }
            
            for (const batch of batches) {
                await Promise.allSettled(
                    batch.map(async (feed) => {
                        try {
                            const result = await fetchFeed(feed, false); // Don't use cache for fresh fetch
                            processFeedResult(result);
                            return result;
                        } catch (error) {
                            // Only log errors in development
                            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                                console.error(`Error in batch processing: ${feed.name}`, error);
                            }
                            return { status: 'error', source: feed.name, error: error.message };
                        }
                    })
                );
            }
        }

        async function fetchAllFeeds() {
            elements.feedContainer.innerHTML = '';
            elements.loadingMessage.style.display = 'flex';
            elements.errorMessage.style.display = 'none';
            elements.retryButton.style.display = 'none';
            
            state.feedStatus = {};
            state.allItems = [];

            const total = rssFeeds.length;
            let completed = 0;
            let loadedFromCache = 0;

            // Step 1: Load cached feeds immediately for instant display
            if (CONFIG.USE_CACHE_FIRST) {
                const cachedFeeds = [];
                rssFeeds.forEach(feed => {
                    const cacheKey = getCacheKey(feed.url);
                    const cached = loadFromStorage(cacheKey);
                    if (cached) {
                        cachedFeeds.push({ ...cached, source: feed.name, cached: true });
                        loadedFromCache++;
                    }
                });

                // Process cached feeds immediately
                cachedFeeds.forEach(result => {
                    processFeedResult(result);
                    completed++;
                    state.feedStatus[result.source] = 'success';
                });

                // Update UI with cached data
                if (state.allItems.length > 0) {
                    if (state.selectedSources.size === 0) {
                        const loadedSources = new Set(state.allItems.map(item => item.sourceName));
                        state.selectedSources = new Set(loadedSources);
                        savePreferences();
                    }
                    initializeSourceFilters();
                    applyFilters();
                    // Keep loading message visible while fetching fresh data
                    if (elements.loadingStatus) {
                        elements.loadingStatus.textContent = `Loaded ${loadedFromCache} from cache. Fetching fresh data...`;
                    }
                }
            }

            // Step 2: Load fresh feeds in batches with progress updates
            const updateProgress = () => {
                const progress = Math.round((completed / total) * 100);
                if (elements.loadingProgress) {
                    elements.loadingProgress.style.width = `${progress}%`;
                    const progressBar = elements.loadingProgress.closest('[role="progressbar"]');
                    if (progressBar) {
                        progressBar.setAttribute('aria-valuenow', progress);
                        progressBar.setAttribute('aria-label', `Loading progress: ${progress}%`);
                    }
                }
                if (elements.loadingStatus) {
                    const remaining = total - completed;
                    elements.loadingStatus.textContent = loadedFromCache > 0 
                        ? `Loaded ${loadedFromCache} from cache. Fetching fresh data... (${completed}/${total}, ${remaining} remaining)`
                        : `Loading feeds... (${completed}/${total}, ${remaining} remaining)`;
                }
            };

            // Process feeds in batches
            const batches = [];
            for (let i = 0; i < rssFeeds.length; i += CONFIG.CONCURRENT_FEEDS) {
                batches.push(rssFeeds.slice(i, i + CONFIG.CONCURRENT_FEEDS));
            }

            for (const batch of batches) {
                const batchPromises = batch.map(async (feed) => {
                    try {
                        const result = await fetchFeed(feed, false); // Fresh fetch
                        completed++;
                        updateProgress();
                        
                        // Only process if it's new data (not already in cache)
                        if (!result.cached || result.fallback) {
                            processFeedResult(result);
                        }
                        
                        return result;
                    } catch (error) {
                        completed++;
                        updateProgress();
                        // Only log errors in development
                        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                            console.error(`Error fetching feed: ${feed.name}`, error);
                        }
                        return { status: 'error', source: feed.name, error: error.message };
                    }
                });

                await Promise.allSettled(batchPromises);
                
                // Small delay between batches to avoid overwhelming the API
                if (batches.indexOf(batch) < batches.length - 1) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
            }

            // Final update with better feedback
            elements.loadingMessage.style.display = 'none';
            const updateTime = new Date().toLocaleString();
            elements.lastUpdated.textContent = updateTime;
            elements.lastUpdated.setAttribute('aria-live', 'polite');
            elements.lastUpdated.setAttribute('title', `Last updated at ${updateTime}`);
            localStorage.setItem('lastFeedRefresh', Date.now().toString());
            
            // Show success notification if we loaded new data
            const newItemsCount = state.allItems.length;
            const uniqueSourcesCount = new Set(state.allItems.map(i => i.sourceName)).size;
            
            if (newItemsCount > 0) {
                const cachedCount = loadedFromCache || 0;
                if (cachedCount > 0 && completed > cachedCount) {
                    showNotification(
                        `Loaded ${newItemsCount} articles from ${uniqueSourcesCount} sources (${cachedCount} from cache, ${completed - cachedCount} fresh)`,
                        'success',
                        4000
                    );
                } else if (completed > cachedCount) {
                    showNotification(
                        `Successfully loaded ${newItemsCount} articles from ${uniqueSourcesCount} sources`,
                        'success',
                        3000
                    );
                }
            }
            
            if (state.allItems.length === 0) {
                elements.errorMessage.innerHTML = `
                    <div style="display: flex; flex-direction: column; gap: 12px; align-items: center;">
                        <div style="font-size: 2em;">‚ö†Ô∏è</div>
                        <div><strong>No feeds could be loaded</strong></div>
                        <div style="font-size: 0.9em; color: #999; margin-top: 8px;">
                            This could be due to:<br>
                            ‚Ä¢ Network connectivity issues<br>
                            ‚Ä¢ API rate limiting<br>
                            ‚Ä¢ Some feeds being temporarily unavailable
                        </div>
                        <div style="font-size: 0.85em; color: #777; margin-top: 12px;">
                            üí° <strong>Tip:</strong> Check your internet connection and try again. Cached articles may still be available.
                        </div>
                    </div>
                `;
                elements.errorMessage.style.display = 'block';
                elements.retryButton.style.display = 'block';
                elements.retryButton.focus();
            } else {
                // Final filter initialization
                if (state.selectedSources.size === 0) {
                    const loadedSources = new Set(state.allItems.map(item => item.sourceName));
                    state.selectedSources = new Set(loadedSources);
                    savePreferences();
                }
                initializeSourceFilters();
                applyFilters();
            }
        }

        // Rendering
        function renderFeedItem(item) {
            const feedItem = document.createElement('div');
            feedItem.className = 'feed-item';
            feedItem.setAttribute('data-source', item.sourceName || 'Unknown');
            
            // Safely handle date
            try {
                const dateTime = item.pubDate instanceof Date ? item.pubDate.getTime() : new Date(item.pubDate).getTime();
                if (!isNaN(dateTime)) {
                    feedItem.setAttribute('data-date', dateTime);
                }
            } catch (e) {
                // Invalid date - use current time
                feedItem.setAttribute('data-date', Date.now());
            }

            const link = document.createElement('a');
            
            // Validate and set link
            try {
                const url = new URL(item.link);
                link.href = url.href;
            } catch (e) {
                // Invalid URL - use # as fallback
                link.href = '#';
                link.onclick = (e) => {
                    e.preventDefault();
                    showNotification('Invalid article link', 'error', 2000);
                };
            }
            
            link.target = "_blank";
            link.rel = "noopener noreferrer";
            const safeTitle = sanitizeHtml(item.title || 'Untitled');
            const safeSource = item.sourceName || 'Unknown Source';
            link.setAttribute('aria-label', `Read article: ${safeTitle} from ${safeSource}`);
            link.setAttribute('title', `Click to read full article on ${safeSource}`);

            const imageUrl = extractImageUrl(item);
            if (imageUrl) {
                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = safeTitle || 'Article image';
                img.loading = 'lazy';
                img.decoding = 'async';
                img.onerror = function() {
                    this.style.display = 'none';
                    const noImage = document.createElement('div');
                    noImage.className = 'no-image';
                    link.insertBefore(noImage, link.firstChild);
                };
                link.appendChild(img);
            } else {
                const noImage = document.createElement('div');
                noImage.className = 'no-image';
                link.appendChild(noImage);
            }

            const title = document.createElement('h2');
            title.textContent = safeTitle;
            title.setAttribute('aria-label', `Article: ${safeTitle}`);
            link.appendChild(title);

            const pubDate = document.createElement('div');
            pubDate.className = 'pub-date';
            const readingTime = estimateReadingTime(item.description || '');
            pubDate.innerHTML = `
                <span>üïí ${getRelativeTime(item.pubDate)}</span>
                ${readingTime ? `<span class="reading-time">üìñ ${readingTime}</span>` : ''}
            `;
            link.appendChild(pubDate);

            const description = document.createElement('p');
            const descText = sanitizeHtml(item.description || "No description available.");
            description.textContent = descText;
            description.setAttribute('aria-label', `Description: ${descText.substring(0, 100)}${descText.length > 100 ? '...' : ''}`);
            link.appendChild(description);

            const source = document.createElement('div');
            source.className = 'source';
            const safeSourceName = item.sourceName || 'Unknown Source';
            source.textContent = safeSourceName;
            source.setAttribute('aria-label', `Source: ${safeSourceName}`);
            link.appendChild(source);

            const status = document.createElement('div');
            status.className = 'feed-status';
            const sourceName = item.sourceName || 'Unknown';
            if (state.feedStatus[sourceName] === 'error') {
                status.classList.add('error');
            }
            feedItem.appendChild(status);

            // Article actions
            const actions = document.createElement('div');
            actions.className = 'article-actions';
            
            const shareBtn = document.createElement('button');
            shareBtn.className = 'action-btn';
            shareBtn.innerHTML = 'üîó';
            shareBtn.title = 'Copy link';
            shareBtn.onclick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                copyToClipboard(item.link, 'Article link copied to clipboard!');
                
                // Visual feedback
                shareBtn.innerHTML = '‚úì';
                shareBtn.style.background = 'var(--success-color)';
                setTimeout(() => {
                    shareBtn.innerHTML = 'üîó';
                    shareBtn.style.background = '';
                }, 1000);
            };
            
            const shareBtn2 = document.createElement('button');
            shareBtn2.className = 'action-btn';
            shareBtn2.innerHTML = 'üì§';
            shareBtn2.title = 'Share article';
            shareBtn2.onclick = (e) => {
                e.preventDefault();
                e.stopPropagation();
                shareArticle(item);
            };
            
            actions.appendChild(shareBtn);
            actions.appendChild(shareBtn2);
            feedItem.appendChild(actions);

            feedItem.appendChild(link);
            return feedItem;
        }

        function renderFeeds() {
            // Smooth transition when updating
            if (elements.feedContainer.children.length > 0) {
                elements.feedContainer.style.opacity = '0.7';
                elements.feedContainer.style.transition = 'opacity 0.2s ease';
            }
            
            setTimeout(() => {
                elements.feedContainer.innerHTML = '';

                if (state.filteredItems.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.setAttribute('role', 'status');
                emptyState.setAttribute('aria-live', 'polite');
                const hasFilters = state.searchQuery || state.dateFilter !== 'all' || state.selectedSources.size > 0;
                const helpTips = hasFilters ? `
                    <div class="empty-state-help">
                        <div class="empty-state-help-title">üí° Tips to find more articles:</div>
                        <div class="empty-state-help-text">
                            <ul style="margin: 8px 0; padding-left: 20px; text-align: left; display: inline-block;">
                                <li>Try different keywords or remove some search terms</li>
                                <li>Select more sources from the sidebar</li>
                                <li>Adjust the date range to include more articles</li>
                                <li>Check spelling of search terms</li>
                                <li>Clear all filters to see everything</li>
                            </ul>
                        </div>
                    </div>
                ` : `
                    <div class="empty-state-help">
                        <div class="empty-state-help-title">üí° Getting Started:</div>
                        <div class="empty-state-help-text">
                            <ul style="margin: 8px 0; padding-left: 20px; text-align: left; display: inline-block;">
                                <li>Use the quick filter buttons above to focus on specific topics</li>
                                <li>Search for keywords like "vulnerability", "ransomware", or "CVE"</li>
                                <li>Select specific sources from the sidebar filters</li>
                                <li>Use date filters to find recent articles</li>
                                <li>Articles are loading in the background - check back soon!</li>
                            </ul>
                        </div>
                    </div>
                `;
                emptyState.innerHTML = `
                    <div class="empty-state-icon">${hasFilters ? 'üîç' : 'üì∞'}</div>
                    <h3>${hasFilters ? 'No articles found' : 'No articles available'}</h3>
                    <p>${hasFilters ? 'Try adjusting your search or filter criteria' : 'Feeds are loading or no articles match your current filters'}</p>
                    ${hasFilters ? '<button class="button" onclick="document.getElementById(\'clearFiltersBtn\').click()" style="margin-top: 20px;" aria-label="Clear all filters">Clear All Filters</button>' : ''}
                    ${helpTips}
                `;
                elements.feedContainer.appendChild(emptyState);
                return;
            }

                state.filteredItems.forEach((item, index) => {
                    const feedItem = renderFeedItem(item);
                    // Stagger animation for better visual flow
                    feedItem.style.animationDelay = `${index * 0.03}s`;
                    elements.feedContainer.appendChild(feedItem);
                });

                // Restore opacity
                elements.feedContainer.style.opacity = '1';
                updateStats();
            }, 100);
        }

        // Date filtering utilities
        function getDateRange(filterType) {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            
            switch (filterType) {
                case 'today':
                    return { from: today, to: now };
                case 'week':
                    const weekAgo = new Date(today);
                    weekAgo.setDate(weekAgo.getDate() - 7);
                    return { from: weekAgo, to: now };
                case 'month':
                    const monthAgo = new Date(today);
                    monthAgo.setMonth(monthAgo.getMonth() - 1);
                    return { from: monthAgo, to: now };
                case 'custom':
                    return {
                        from: state.dateFrom ? new Date(state.dateFrom) : null,
                        to: state.dateTo ? new Date(state.dateTo + 'T23:59:59') : null
                    };
                default:
                    return { from: null, to: null };
            }
        }

        function isDateInRange(itemDate, dateRange) {
            if (!dateRange.from && !dateRange.to) return true;
            
            try {
                const item = new Date(itemDate);
                
                // Handle invalid dates
                if (isNaN(item.getTime())) {
                    return false;
                }
                
                if (dateRange.from && item < dateRange.from) return false;
                if (dateRange.to && item > dateRange.to) return false;
                
                return true;
            } catch (e) {
                // Invalid date - exclude from results
                return false;
            }
        }

        // Filtering and sorting
        function applyFilters() {
            if (!Array.isArray(state.allItems)) {
                state.allItems = [];
            }
            let filtered = [...state.allItems];
            const initialCount = filtered.length;

            // Date filter
            if (state.dateFilter !== 'all') {
                const dateRange = getDateRange(state.dateFilter);
                const beforeDateFilter = filtered.length;
                filtered = filtered.filter(item => isDateInRange(item.pubDate, dateRange));
                
                // Provide feedback if date filter removed many items
                if (beforeDateFilter > 0 && filtered.length === 0 && state.dateFilter !== 'all') {
                    // Will be handled by empty state
                }
            }

            // Search filter
            if (state.searchQuery) {
                const query = state.searchQuery.toLowerCase().trim();
                if (query.length > 0) {
                    const beforeSearch = filtered.length;
                    filtered = filtered.filter(item => {
                        if (!item || !item.title) return false;
                        try {
                            const title = sanitizeHtml(item.title || '').toLowerCase();
                            const desc = sanitizeHtml(item.description || '').toLowerCase();
                            const source = (item.sourceName || '').toLowerCase();
                            return title.includes(query) || desc.includes(query) || source.includes(query);
                        } catch (e) {
                            return false;
                        }
                    });
                    
                    // Show helpful message for very specific searches
                    if (filtered.length === 0 && beforeSearch > 0 && query.length > 3) {
                        // Message will be shown in empty state
                    }
                }
            }

            // Source filter
            if (state.selectedSources && state.selectedSources.size > 0) {
                filtered = filtered.filter(item =>
                    item && item.sourceName && state.selectedSources.has(item.sourceName)
                );
            }

            // Sort
            filtered.sort((a, b) => {
                switch (state.sortBy) {
                    case 'date-desc':
                        return b.pubDate - a.pubDate;
                    case 'date-asc':
                        return a.pubDate - b.pubDate;
                    case 'source':
                        return a.sourceName.localeCompare(b.sourceName);
                    default:
                        return 0;
                }
            });

            state.filteredItems = filtered;
            
            // Show helpful message if filters are very restrictive
            if (initialCount > 0 && filtered.length === 0) {
                // Empty state will handle this
            } else if (initialCount > filtered.length && filtered.length > 0) {
                // Filters are active but results found
                const reductionPercent = Math.round((1 - filtered.length / initialCount) * 100);
                if (reductionPercent > 80) {
                    // Very restrictive filters - could show subtle hint
                }
            }
            
            renderFeeds();
        }

        function updateStats() {
            const uniqueSources = new Set(state.allItems.map(item => item.sourceName));
            
            // Animate number changes for better UX
            const animateNumber = (element, newValue, oldValue) => {
                if (oldValue === newValue) {
                    element.textContent = newValue;
                    return;
                }
                
                const duration = 300;
                const steps = 20;
                const increment = (newValue - oldValue) / steps;
                let current = oldValue;
                let step = 0;
                
                const timer = setInterval(() => {
                    step++;
                    current += increment;
                    if (step >= steps) {
                        element.textContent = newValue;
                        clearInterval(timer);
                    } else {
                        element.textContent = Math.round(current);
                    }
                }, duration / steps);
            };
            
            const oldTotal = parseInt(elements.totalCount.textContent) || 0;
            const oldShowing = parseInt(elements.showingCount.textContent) || 0;
            const oldSources = parseInt(elements.sourceCount.textContent) || 0;
            
            animateNumber(elements.totalCount, state.allItems.length, oldTotal);
            animateNumber(elements.showingCount, state.filteredItems.length, oldShowing);
            animateNumber(elements.sourceCount, uniqueSources.size, oldSources);
            
            // Update aria-live for screen readers
            if (state.filteredItems.length !== oldShowing) {
                const change = state.filteredItems.length - oldShowing;
                const message = change > 0 
                    ? `Showing ${state.filteredItems.length} articles` 
                    : `Filtered to ${state.filteredItems.length} articles`;
                elements.feedContainer.setAttribute('aria-label', message);
            }
        }

        // Source categories mapping
        const sourceCategories = {
            'government': {
                name: 'üèõÔ∏è Government & Critical Infrastructure',
                icon: 'üèõÔ∏è',
                keywords: ['CISA', 'CERT', 'NIST', 'NCSC', 'US-CERT', 'Government']
            },
            'news': {
                name: 'üïµÔ∏è Investigative Journalism & Breaking News',
                icon: 'üïµÔ∏è',
                keywords: ['Krebs', 'Hacker News', 'Dark Reading', 'BleepingComputer', 'Schneier', 'Risky Business', 'Graham Cluley', 'SecurityWeek', 'Help Net Security', 'Security Affairs', 'Cyber Security News', 'HackRead']
            },
            'research': {
                name: 'üî¨ Threat Research & Malware Analysis',
                icon: 'üî¨',
                keywords: ['Project Zero', 'Talos', 'SANS', 'Mandiant', 'Securelist', 'Sophos Threat', 'Malwarebytes', 'Check Point', 'Unit 42', 'WeLiveSecurity', 'CrowdStrike', 'TAG', 'Trail of Bits', 'Zero Day Initiative']
            },
            'offensive': {
                name: 'üõ°Ô∏è Offensive Security & Hacking Techniques',
                icon: 'üõ°Ô∏è',
                keywords: ['OffSec', 'Offensive Security', 'Bishop Fox', 'Hacking The Cloud', 'Hack The Box', 'KitPloit', 'MalwareTech', 'DFIR', 'InfoSec Writeups', 'Pentest']
            },
            'cloud': {
                name: '‚òÅÔ∏è Platform & Cloud Security',
                icon: '‚òÅÔ∏è',
                keywords: ['AWS Security', 'Microsoft Security', 'MSRC', 'Cloud']
            },
            'community': {
                name: 'üë• Community & Forums',
                icon: 'üë•',
                keywords: ['reddit', 'r/netsec', 'r/blueteamsec', 'Hacker News', 'Community']
            },
            'bugbounty': {
                name: 'üéØ Bug Bounty & Responsible Disclosure',
                icon: 'üéØ',
                keywords: ['Bug Bounty', 'Intigriti', 'YesWeHack', 'HackerOne', 'Bug Bounty Writeups']
            }
        };

        function getSourceCategory(sourceName) {
            const nameLower = sourceName.toLowerCase();
            for (const [key, category] of Object.entries(sourceCategories)) {
                if (category.keywords.some(keyword => nameLower.includes(keyword.toLowerCase()))) {
                    return key;
                }
            }
            return 'other';
        }

        function initializeSourceFilters() {
            // Get all available sources from rssFeeds
            const allAvailableSources = rssFeeds.map(feed => feed.name);
            
            // Get sources that have items loaded
            const loadedSources = new Set(state.allItems.map(item => item.sourceName));
            
            // Get source counts
            const sourceCounts = {};
            state.allItems.forEach(item => {
                sourceCounts[item.sourceName] = (sourceCounts[item.sourceName] || 0) + 1;
            });
            
            // Filter sources based on search
            const searchQuery = (elements.sourceSearch.value || '').toLowerCase();
            
            // Group sources by category
            const categorizedSources = {};
            allAvailableSources.forEach(source => {
                if (searchQuery && !source.toLowerCase().includes(searchQuery)) {
                    return; // Skip if doesn't match search
                }
                
                const category = getSourceCategory(source);
                if (!categorizedSources[category]) {
                    categorizedSources[category] = [];
                }
                categorizedSources[category].push(source);
            });
            
            elements.sourceFilters.innerHTML = '';
            
            if (Object.keys(categorizedSources).length === 0) {
                const noResults = document.createElement('div');
                noResults.className = 'source-filters-empty';
                noResults.innerHTML = `
                    <div class="source-filters-empty-icon">üîç</div>
                    <h3>No sources found</h3>
                    <p>Try adjusting your search query or clear the search</p>
                `;
                elements.sourceFilters.appendChild(noResults);
                updateSourceFilterCount();
                return;
            }
            
            // Render categories
            Object.entries(categorizedSources).forEach(([categoryKey, sources]) => {
                const category = sourceCategories[categoryKey] || { name: 'üì∞ Other Sources', icon: 'üì∞' };
                
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'source-category';
                categoryDiv.dataset.category = categoryKey;
                
                const header = document.createElement('div');
                header.className = 'category-header';
                // Default to expanded if not in state (first load)
                const isExpanded = state.expandedCategories.has(categoryKey) || state.expandedCategories.size === 0;
                header.dataset.expanded = isExpanded ? 'true' : 'false';
                if (isExpanded && !state.expandedCategories.has(categoryKey)) {
                    state.expandedCategories.add(categoryKey);
                }
                
                const titleDiv = document.createElement('div');
                titleDiv.className = 'category-title';
                titleDiv.innerHTML = `
                    <span class="category-icon">${category.icon}</span>
                    <span>${category.name.replace(category.icon, '').trim()}</span>
                    <span class="category-badge">${sources.length}</span>
                `;
                
                const content = document.createElement('div');
                content.className = 'category-content expanded';
                
                const selectAllBtn = document.createElement('button');
                selectAllBtn.className = 'category-select-all';
                selectAllBtn.textContent = 'Select All';
                selectAllBtn.title = 'Select all sources in this category';
                selectAllBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const checkboxes = content.querySelectorAll('input[type="checkbox"]:not(:disabled)');
                    checkboxes.forEach(checkbox => {
                        checkbox.checked = true;
                        state.selectedSources.add(checkbox.value);
                        checkbox.closest('.source-filter-item')?.classList.add('checked');
                    });
                    savePreferences();
                    applyFilters();
                    updateSourceFilterCount();
                });
                
                const toggle = document.createElement('span');
                toggle.className = 'category-toggle';
                toggle.textContent = isExpanded ? '‚ñº' : '‚ñ∂';
                if (!isExpanded) {
                    toggle.classList.add('collapsed');
                }
                
                header.appendChild(titleDiv);
                header.appendChild(selectAllBtn);
                header.appendChild(toggle);
                
                // Sort sources
                sources.sort().forEach(source => {
                    const isLoaded = loadedSources.has(source);
                    const item = createSourceFilterItem(source, isLoaded, sourceCounts[source] || 0);
                    content.appendChild(item);
                });
                
                // Toggle functionality
                header.addEventListener('click', (e) => {
                    if (e.target === selectAllBtn || e.target.closest('.category-select-all')) return;
                    const currentlyExpanded = header.dataset.expanded === 'true';
                    const newExpanded = !currentlyExpanded;
                    header.dataset.expanded = newExpanded ? 'true' : 'false';
                    content.classList.toggle('expanded', newExpanded);
                    toggle.textContent = newExpanded ? '‚ñº' : '‚ñ∂';
                    toggle.classList.toggle('collapsed', !newExpanded);
                    if (newExpanded) {
                        state.expandedCategories.add(categoryKey);
                    } else {
                        state.expandedCategories.delete(categoryKey);
                    }
                    savePreferences();
                });
                
                categoryDiv.appendChild(header);
                categoryDiv.appendChild(content);
                elements.sourceFilters.appendChild(categoryDiv);
            });
            
            updateSourceFilterCount();
        }

        function createSourceFilterItem(source, isLoaded, count) {
            const item = document.createElement('div');
            item.className = 'source-filter-item';
            
            if (!isLoaded) {
                item.classList.add('disabled');
            }
            
            const status = document.createElement('div');
            status.className = 'source-status';
            if (!isLoaded) {
                status.classList.add('loading');
            }
            
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = `source-${source.replace(/\s+/g, '-').replace(/[^a-zA-Z0-9-]/g, '')}`;
            checkbox.value = source;
            
            // Initialize: if no sources selected, select all loaded sources
            // Otherwise, use saved preferences
            if (state.selectedSources.size === 0) {
                if (isLoaded) {
                    state.selectedSources.add(source);
                    checkbox.checked = true;
                } else {
                    checkbox.checked = false;
                }
            } else {
                checkbox.checked = state.selectedSources.has(source);
            }
            
            checkbox.disabled = !isLoaded;
            
            if (checkbox.checked) {
                item.classList.add('checked');
            }
            
            checkbox.addEventListener('change', (e) => {
                if (e.target.checked) {
                    state.selectedSources.add(source);
                    item.classList.add('checked');
                } else {
                    state.selectedSources.delete(source);
                    item.classList.remove('checked');
                }
                savePreferences();
                applyFilters();
                updateSourceFilterCount();
            });
            
            const label = document.createElement('label');
            label.htmlFor = checkbox.id;
            label.textContent = source;
            
            const countSpan = document.createElement('span');
            countSpan.className = 'source-count';
            countSpan.textContent = isLoaded ? count : '...';
            
            item.appendChild(status);
            item.appendChild(checkbox);
            item.appendChild(label);
            item.appendChild(countSpan);
            
            return item;
        }

        function updateSourceFilterCount() {
            const selectedCount = state.selectedSources.size;
            const totalCount = rssFeeds.length;
            const badge = elements.sourceFilterCount;
            
            if (selectedCount === 0) {
                badge.textContent = 'None selected';
                badge.title = 'No sources selected. Click "All" to select all sources.';
                badge.style.opacity = '0.6';
            } else if (selectedCount === totalCount) {
                badge.textContent = 'All selected';
                badge.title = 'All sources are selected. Click "None" to deselect all.';
                badge.style.opacity = '1';
            } else {
                badge.textContent = `${selectedCount} of ${totalCount}`;
                badge.title = `${selectedCount} out of ${totalCount} sources are selected.`;
                badge.style.opacity = '1';
            }
        }

        // Debounce search for better performance with visual feedback
        let searchTimeout = null;
        let lastSearchQuery = '';
        
        elements.searchInput.addEventListener('input', (e) => {
            const query = e.target.value;
            state.searchQuery = query;
            
            // Clear previous timeout
            clearTimeout(searchTimeout);
            
            // Show loading indicator for search
            if (query.length > 0) {
                elements.feedContainer.setAttribute('aria-busy', 'true');
                // Show subtle loading indicator
                if (query.length !== lastSearchQuery.length) {
                    // User is actively typing
                }
            } else {
                elements.feedContainer.setAttribute('aria-busy', 'false');
            }
            
            // Debounce search to avoid excessive filtering
            searchTimeout = setTimeout(() => {
                applyFilters();
                elements.feedContainer.setAttribute('aria-busy', 'false');
                lastSearchQuery = query;
                
                // Provide helpful feedback
                if (state.filteredItems.length === 0 && query.length > 0) {
                    // Empty state will handle this
                } else if (state.filteredItems.length > 0 && query.length > 0) {
                    // Subtle feedback that search worked
                    const searchResults = state.filteredItems.length;
                    if (searchResults < 5 && query.length > 3) {
                        // Very few results - could show hint
                    }
                }
            }, 300);
        });
        
        // Clear search button functionality
        elements.searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && elements.searchInput.value) {
                elements.searchInput.value = '';
                state.searchQuery = '';
                clearTimeout(searchTimeout);
                applyFilters();
                showNotification('Search cleared', 'info', 1500);
            }
        });

        elements.sortSelect.addEventListener('change', (e) => {
            state.sortBy = e.target.value;
            savePreferences();
            applyFilters();
        });

        elements.dateFilter.addEventListener('change', (e) => {
            state.dateFilter = e.target.value;
            
            // Show/hide custom date range inputs
            if (state.dateFilter === 'custom') {
                elements.customDateRange.style.display = 'flex';
            } else {
                elements.customDateRange.style.display = 'none';
                state.dateFrom = null;
                state.dateTo = null;
            }
            
            savePreferences();
            applyFilters();
        });

        // Set max date to today for date inputs
        const today = new Date().toISOString().split('T')[0];
        elements.dateFrom.setAttribute('max', today);
        elements.dateTo.setAttribute('max', today);

        elements.dateFrom.addEventListener('change', (e) => {
            const selectedDate = e.target.value;
            
            // Validate date is not in the future
            if (selectedDate > today) {
                showNotification('Date cannot be in the future', 'warning', 2500);
                e.target.value = today;
                state.dateFrom = today;
            } else {
                state.dateFrom = selectedDate;
            }
            
            // Auto-adjust end date if it's before start date
            if (state.dateFrom && state.dateTo && state.dateFrom > state.dateTo) {
                elements.dateTo.value = state.dateFrom;
                state.dateTo = state.dateFrom;
                showNotification('End date adjusted to match start date', 'info', 2000);
            }
            
            // Validate date range is not too large (optional - can be removed)
            if (state.dateFrom && state.dateTo) {
                const fromDate = new Date(state.dateFrom);
                const toDate = new Date(state.dateTo);
                const daysDiff = Math.ceil((toDate - fromDate) / (1000 * 60 * 60 * 24));
                if (daysDiff > 365) {
                    showNotification('Date range is very large. Results may take longer to load.', 'warning', 3000);
                }
            }
            
            savePreferences();
            applyFilters();
        });

        elements.dateTo.addEventListener('change', (e) => {
            const selectedDate = e.target.value;
            
            // Validate date is not in the future
            if (selectedDate > today) {
                showNotification('Date cannot be in the future', 'warning', 2500);
                e.target.value = today;
                state.dateTo = today;
            } else {
                state.dateTo = selectedDate;
            }
            
            // Auto-adjust start date if it's after end date
            if (state.dateFrom && state.dateTo && state.dateFrom > state.dateTo) {
                elements.dateFrom.value = state.dateTo;
                state.dateFrom = state.dateTo;
                showNotification('Start date adjusted to match end date', 'info', 2000);
            }
            
            // Validate date range
            if (state.dateFrom && state.dateTo) {
                const fromDate = new Date(state.dateFrom);
                const toDate = new Date(state.dateTo);
                const daysDiff = Math.ceil((toDate - fromDate) / (1000 * 60 * 60 * 24));
                if (daysDiff > 365) {
                    showNotification('Date range is very large. Results may take longer to load.', 'warning', 3000);
                }
            }
            
            savePreferences();
            applyFilters();
        });

        elements.sourceSearch.addEventListener('input', (e) => {
            initializeSourceFilters();
            // Clear preset active state when searching
            document.querySelectorAll('.preset-btn').forEach(btn => btn.classList.remove('active'));
        });

        elements.selectAllSources.addEventListener('click', () => {
            const checkboxes = elements.sourceFilters.querySelectorAll('input[type="checkbox"]:not(:disabled)');
            checkboxes.forEach(checkbox => {
                checkbox.checked = true;
                state.selectedSources.add(checkbox.value);
                checkbox.closest('.source-filter-item')?.classList.add('checked');
            });
            savePreferences();
            applyFilters();
            updateSourceFilterCount();
        });

        elements.deselectAllSources.addEventListener('click', () => {
            state.selectedSources.clear();
            const checkboxes = elements.sourceFilters.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
                checkbox.closest('.source-filter-item')?.classList.remove('checked');
            });
            savePreferences();
            applyFilters();
            updateSourceFilterCount();
        });

        elements.expandAllCategories.addEventListener('click', () => {
            const headers = elements.sourceFilters.querySelectorAll('.category-header');
            headers.forEach(header => {
                if (header.dataset.expanded !== 'true') {
                    header.click();
                }
            });
        });

        elements.collapseAllCategories.addEventListener('click', () => {
            const headers = elements.sourceFilters.querySelectorAll('.category-header');
            headers.forEach(header => {
                if (header.dataset.expanded === 'true') {
                    header.click();
                }
            });
        });

        // Preset buttons with better feedback
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const preset = btn.dataset.preset;
                
                // Remove active from all
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // Deselect all first
                state.selectedSources.clear();
                const allCheckboxes = elements.sourceFilters.querySelectorAll('input[type="checkbox"]');
                allCheckboxes.forEach(cb => {
                    cb.checked = false;
                    cb.closest('.source-filter-item')?.classList.remove('checked');
                });
                
                // Select sources in this category
                const categoryDiv = elements.sourceFilters.querySelector(`[data-category="${preset}"]`);
                let selectedCount = 0;
                if (categoryDiv) {
                    const checkboxes = categoryDiv.querySelectorAll('input[type="checkbox"]:not(:disabled)');
                    checkboxes.forEach(checkbox => {
                        checkbox.checked = true;
                        state.selectedSources.add(checkbox.value);
                        checkbox.closest('.source-filter-item')?.classList.add('checked');
                        selectedCount++;
                    });
                    
                    // Expand the category
                    const header = categoryDiv.querySelector('.category-header');
                    if (header.dataset.expanded !== 'true') {
                        header.click();
                    }
                }
                
                savePreferences();
                applyFilters();
                updateSourceFilterCount();
                
                const presetNames = {
                    government: 'Government',
                    news: 'News',
                    research: 'Research',
                    offensive: 'Offensive Security',
                    bugbounty: 'Bug Bounty',
                    cloud: 'Cloud Security',
                    community: 'Community'
                };
                
                showNotification(
                    `Filtered to ${selectedCount} ${presetNames[preset] || preset} source${selectedCount !== 1 ? 's' : ''}`,
                    'success',
                    2500
                );
            });
        });

        elements.retryButton.addEventListener('click', fetchAllFeeds);

        // Welcome banner close
        const closeWelcomeBanner = document.getElementById('closeWelcomeBanner');
        const welcomeBanner = document.getElementById('welcomeBanner');
        if (closeWelcomeBanner && welcomeBanner) {
            closeWelcomeBanner.addEventListener('click', () => {
                welcomeBanner.classList.add('hidden');
                localStorage.setItem('welcomeBannerDismissed', 'true');
            });
            
            // Check if banner was previously dismissed
            if (localStorage.getItem('welcomeBannerDismissed') === 'true') {
                welcomeBanner.classList.add('hidden');
            }
        }

        // Header refresh button with better UX
        const headerRefreshBtn = document.getElementById('headerRefreshBtn');
        if (headerRefreshBtn) {
            headerRefreshBtn.addEventListener('click', () => {
                if (headerRefreshBtn.disabled) return; // Prevent double-click
                
                headerRefreshBtn.classList.add('loading');
                headerRefreshBtn.disabled = true;
                const originalHTML = headerRefreshBtn.innerHTML;
                headerRefreshBtn.innerHTML = '<span class="refresh-icon">‚è≥</span><span>Refreshing...</span>';
                
                // Clear cache to force fresh fetch
                const cacheKeys = Object.keys(localStorage).filter(key => key.startsWith('feed_'));
                cacheKeys.forEach(key => localStorage.removeItem(key));
                
                fetchAllFeeds().finally(() => {
                    setTimeout(() => {
                        headerRefreshBtn.classList.remove('loading');
                        headerRefreshBtn.disabled = false;
                        headerRefreshBtn.innerHTML = originalHTML;
                    }, 500);
                });
            });
        }

        elements.toggleButton.addEventListener('click', () => {
            const isAtBottom = (window.innerHeight + window.scrollY) >= document.body.offsetHeight - 100;
            if (isAtBottom) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                elements.arrowIcon.textContent = '‚Üë';
            } else {
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
                elements.arrowIcon.textContent = '‚Üì';
            }
        });

        // Toggle auto-refresh with click and keyboard support
        function toggleAutoRefresh() {
            state.autoRefreshEnabled = !state.autoRefreshEnabled;
            elements.autoRefreshToggle.classList.toggle('active', state.autoRefreshEnabled);
            elements.autoRefreshToggle.setAttribute('aria-checked', state.autoRefreshEnabled);
            savePreferences();
            
            if (state.autoRefreshEnabled) {
                startAutoRefresh();
                showNotification('Auto-refresh enabled. Feeds will update every 30 minutes.', 'success', 3000);
            } else {
                stopAutoRefresh();
                showNotification('Auto-refresh disabled.', 'info', 2000);
            }
        }

        elements.autoRefreshToggle.addEventListener('click', toggleAutoRefresh);
        
        // Keyboard support for toggle switch
        elements.autoRefreshToggle.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                toggleAutoRefresh();
            }
        });

        // Auto-refresh
        function startAutoRefresh() {
            stopAutoRefresh();
            state.refreshTimer = setInterval(() => {
                fetchAllFeeds();
            }, CONFIG.AUTO_REFRESH_INTERVAL);
            
            const minutes = CONFIG.AUTO_REFRESH_INTERVAL / 60000;
            elements.refreshInterval.textContent = `${minutes} min`;
            elements.autoRefreshToggle.setAttribute('aria-checked', 'true');
            localStorage.setItem('lastFeedRefresh', Date.now().toString());
        }

        function stopAutoRefresh() {
            if (state.refreshTimer) {
                clearInterval(state.refreshTimer);
                state.refreshTimer = null;
            }
            elements.refreshInterval.textContent = 'Off';
            elements.autoRefreshToggle.setAttribute('aria-checked', 'false');
            localStorage.removeItem('lastFeedRefresh');
        }

        // Export functionality with better feedback
        elements.exportBtn.addEventListener('click', () => {
            if (state.filteredItems.length === 0) {
                showNotification('No articles to export. Try adjusting your filters.', 'warning', 3000);
                return;
            }
            
            // Show loading state
            const originalText = elements.exportBtn.innerHTML;
            elements.exportBtn.innerHTML = '‚è≥ Exporting...';
            elements.exportBtn.disabled = true;
            
            try {
                const exportData = {
                    metadata: {
                        exportedAt: new Date().toISOString(),
                        totalArticles: state.filteredItems.length,
                        filters: {
                            searchQuery: state.searchQuery,
                            dateFilter: state.dateFilter,
                            selectedSources: Array.from(state.selectedSources),
                            sortBy: state.sortBy
                        }
                    },
                    articles: state.filteredItems.map(item => ({
                        title: item.title,
                        source: item.sourceName,
                        date: item.pubDate.toISOString(),
                        link: item.link,
                        description: sanitizeHtml(item.description || '')
                    }))
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `threat-intel-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                
                showNotification(`Successfully exported ${state.filteredItems.length} articles!`, 'success', 3000);
            } catch (error) {
                // Only log errors in development
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    console.error('Export error:', error);
                }
                showNotification('Failed to export articles. Please try again.', 'error', 3000);
            } finally {
                setTimeout(() => {
                    elements.exportBtn.innerHTML = originalText;
                    elements.exportBtn.disabled = false;
                }, 500);
            }
        });

        // Clear filters with confirmation for better UX
        elements.clearFiltersBtn.addEventListener('click', () => {
            const hasActiveFilters = state.searchQuery || 
                                   state.dateFilter !== 'all' || 
                                   state.selectedSources.size < rssFeeds.length;
            
            if (!hasActiveFilters) {
                showNotification('No active filters to clear', 'info', 2000);
                return;
            }
            
            // Smooth transition
            elements.feedContainer.style.opacity = '0.7';
            elements.feedContainer.style.transition = 'opacity 0.2s ease';
            
            setTimeout(() => {
                state.searchQuery = '';
                state.dateFilter = 'all';
                state.dateFrom = null;
                state.dateTo = null;
                state.selectedSources.clear();
                
                elements.searchInput.value = '';
                elements.dateFilter.value = 'all';
                elements.dateFrom.value = '';
                elements.dateTo.value = '';
                elements.customDateRange.style.display = 'none';
                
                initializeSourceFilters();
                savePreferences();
                applyFilters();
                
                elements.feedContainer.style.opacity = '1';
                showNotification('All filters cleared', 'success', 2000);
            }, 200);
        });

        // Help modal with comprehensive tips
        elements.helpBtn.addEventListener('click', () => {
            const helpModal = document.createElement('div');
            helpModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                backdrop-filter: blur(5px);
                overflow-y: auto;
                padding: 20px;
            `;
            helpModal.innerHTML = `
                <div style="
                    background: var(--card-background);
                    padding: 30px;
                    border-radius: 12px;
                    max-width: 600px;
                    width: 100%;
                    border: 1px solid var(--border-color);
                    box-shadow: var(--shadow);
                    max-height: 90vh;
                    overflow-y: auto;
                ">
                    <h2 style="margin-top: 0; color: var(--highlight-color); display: flex; align-items: center; gap: 10px;">
                        <span>üí°</span>
                        <span>Help & Tips</span>
                    </h2>
                    
                    <div style="margin: 25px 0;">
                        <h3 style="color: var(--text-color-bright); font-size: 1.1em; margin-bottom: 12px;">‚å®Ô∏è Keyboard Shortcuts</h3>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border-color);">
                                <span style="display: flex; gap: 6px;"><kbd>/</kbd> or <kbd>F</kbd></span>
                                <span style="color: var(--text-color);">Focus search box</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border-color);">
                                <span><kbd>Ctrl</kbd> + <kbd>R</kbd></span>
                                <span style="color: var(--text-color);">Refresh all feeds</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border-color);">
                                <span><kbd>Esc</kbd></span>
                                <span style="color: var(--text-color);">Close dialogs</span>
                            </div>
                        </div>
                    </div>

                    <div style="margin: 25px 0;">
                        <h3 style="color: var(--text-color-bright); font-size: 1.1em; margin-bottom: 12px;">üîç Search Tips</h3>
                        <ul style="color: var(--text-color); line-height: 1.8; padding-left: 20px; margin: 0;">
                            <li>Search by article title, description, or source name</li>
                            <li>Try keywords like "ransomware", "vulnerability", "CVE"</li>
                            <li>Search is case-insensitive</li>
                            <li>Combine with date filters for better results</li>
                        </ul>
                    </div>

                    <div style="margin: 25px 0;">
                        <h3 style="color: var(--text-color-bright); font-size: 1.1em; margin-bottom: 12px;">üéØ Quick Filters</h3>
                        <ul style="color: var(--text-color); line-height: 1.8; padding-left: 20px; margin: 0;">
                            <li>Use preset buttons to quickly filter by category</li>
                            <li>Click multiple presets to combine categories</li>
                            <li>Select specific sources from the sidebar</li>
                            <li>Use date filters to find recent articles</li>
                        </ul>
                    </div>

                    <div style="margin: 25px 0;">
                        <h3 style="color: var(--text-color-bright); font-size: 1.1em; margin-bottom: 12px;">‚ö° Features</h3>
                        <ul style="color: var(--text-color); line-height: 1.8; padding-left: 20px; margin: 0;">
                            <li><strong>Auto-refresh:</strong> Automatically update feeds every 30 minutes</li>
                            <li><strong>Export:</strong> Download filtered articles as JSON</li>
                            <li><strong>Share:</strong> Click article actions to copy links</li>
                            <li><strong>Cache:</strong> Cached articles load instantly</li>
                        </ul>
                    </div>

                    <button class="button" onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="width: 100%; margin-top: 20px;">
                        Got it! Close
                    </button>
                </div>
            `;
            document.body.appendChild(helpModal);
            helpModal.addEventListener('click', (e) => {
                if (e.target === helpModal) helpModal.remove();
            });
        });

        // Enhanced keyboard shortcuts with better UX
        document.addEventListener('keydown', (e) => {
            // Don't interfere with input fields
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') {
                if (e.key === 'Escape') {
                    e.target.blur();
                    showNotification('Search cleared', 'info', 1500);
                }
                // Allow Ctrl/Cmd + K to clear search
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    if (e.target === elements.searchInput) {
                        elements.searchInput.value = '';
                        state.searchQuery = '';
                        applyFilters();
                        showNotification('Search cleared', 'info', 1500);
                    }
                }
                return;
            }
            
            // Global shortcuts
            if (e.key === '/' || e.key === 'f' || ((e.ctrlKey || e.metaKey) && e.key === 'k')) {
                e.preventDefault();
                elements.searchInput.focus();
                elements.searchInput.select();
                showNotification('Search focused. Type to search articles.', 'info', 2000);
            } else if (e.key === 'r' && (e.ctrlKey || e.metaKey)) {
                e.preventDefault();
                if (headerRefreshBtn && !headerRefreshBtn.disabled) {
                    headerRefreshBtn.click();
                } else {
                    fetchAllFeeds();
                }
            } else if (e.key === 'Escape') {
                const modals = document.querySelectorAll('div[style*="position: fixed"][style*="z-index: 10000"]');
                modals.forEach(modal => modal.remove());
                // Also clear search if focused
                if (document.activeElement === elements.searchInput && elements.searchInput.value) {
                    elements.searchInput.value = '';
                    state.searchQuery = '';
                    applyFilters();
                }
            } else if (e.key === '?' || ((e.ctrlKey || e.metaKey) && e.key === '/')) {
                e.preventDefault();
                elements.helpBtn.click();
            }
        });

        // Initialize with better UX
        let isInitialized = false;
        function init() {
            // Prevent duplicate initialization
            if (isInitialized) {
                return;
            }
            isInitialized = true;
            
            // Show loading immediately
            elements.loadingMessage.style.display = 'flex';
            
            // Load preferences
            loadPreferences();
            
            // Restore welcome banner state
            const welcomeBanner = document.getElementById('welcomeBanner');
            if (welcomeBanner && localStorage.getItem('welcomeBannerDismissed') === 'true') {
                welcomeBanner.classList.add('hidden');
            }
            
            // Fetch feeds with error handling
            fetchAllFeeds().then(() => {
                // Initialize filters after data is loaded
                if (state.selectedSources.size === 0 && state.allItems.length > 0) {
                    const loadedSources = new Set(state.allItems.map(item => item.sourceName));
                    state.selectedSources = new Set(loadedSources);
                    savePreferences();
                }
                initializeSourceFilters();
                applyFilters();
                if (state.autoRefreshEnabled) {
                    startAutoRefresh();
                }
            }).catch(error => {
                // Log initialization errors
                if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                    console.error('Initialization error:', error);
                }
                elements.loadingMessage.style.display = 'none';
                elements.errorMessage.innerHTML = `
                    <div style="display: flex; flex-direction: column; gap: 12px; align-items: center;">
                        <div style="font-size: 2em;">‚ö†Ô∏è</div>
                        <div><strong>Failed to initialize</strong></div>
                        <div style="font-size: 0.9em; color: #999;">
                            ${error.message || 'An unexpected error occurred'}
                        </div>
                        <button class="button" onclick="location.reload()" style="margin-top: 12px;">
                            Reload Page
                        </button>
                    </div>
                `;
                elements.errorMessage.style.display = 'block';
                isInitialized = false; // Allow retry
            });
        }

        // Handle page visibility changes for better UX
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden && state.autoRefreshEnabled) {
                // Page became visible - check if refresh is needed
                const lastRefresh = localStorage.getItem('lastFeedRefresh');
                if (lastRefresh) {
                    const timeSinceRefresh = Date.now() - parseInt(lastRefresh);
                    if (timeSinceRefresh > CONFIG.AUTO_REFRESH_INTERVAL) {
                        // Auto-refresh if it's been more than the interval
                        fetchAllFeeds();
                    }
                }
            }
        });

        // Initialize on load with proper timing
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(init, 50); // Small delay to ensure DOM is ready
            });
        } else {
            // DOM already loaded
            setTimeout(init, 50);
        }
        
        // Fallback initialization check
        window.addEventListener('load', () => {
            if (!isInitialized && state.allItems.length === 0) {
                setTimeout(init, 100);
            }
        });
    </script>
    <script src="../StayUpdated.js"></script>
</body>
</html>